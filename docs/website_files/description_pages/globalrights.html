<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Global Rights Data – Diverse Data Hub</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../website_files/img/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../website_files/styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Diverse Data Hub</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../website_files/datasets.html"> 
<span class="menu-text">Datasets</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#about-the-data" id="toc-about-the-data" class="nav-link active" data-scroll-target="#about-the-data">About the Data</a>
  <ul>
  <li><a href="#download" id="toc-download" class="nav-link" data-scroll-target="#download">Download</a></li>
  <li><a href="#metadata" id="toc-metadata" class="nav-link" data-scroll-target="#metadata">Metadata</a></li>
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables">Variables</a></li>
  <li><a href="#key-features-of-the-dataset" id="toc-key-features-of-the-dataset" class="nav-link" data-scroll-target="#key-features-of-the-dataset"><strong>Key Features of the Dataset</strong></a></li>
  <li><a href="#purpose-and-use-cases" id="toc-purpose-and-use-cases" class="nav-link" data-scroll-target="#purpose-and-use-cases"><strong>Purpose and Use Cases</strong></a></li>
  </ul></li>
  <li><a href="#case-study" id="toc-case-study" class="nav-link" data-scroll-target="#case-study"><strong>Case Study</strong></a>
  <ul>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective"><strong>Objective</strong></a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><strong>Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#loading-libraries" id="toc-loading-libraries" class="nav-link" data-scroll-target="#loading-libraries"><strong>Loading Libraries</strong></a></li>
  <li><a href="#data-cleaning-processing" id="toc-data-cleaning-processing" class="nav-link" data-scroll-target="#data-cleaning-processing"><strong>1. Data Cleaning &amp; Processing</strong></a></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><strong>2. Exploratory Data Analysis (EDA)</strong></a></li>
  <li><a href="#aim-and-hypotheses-of-anova" id="toc-aim-and-hypotheses-of-anova" class="nav-link" data-scroll-target="#aim-and-hypotheses-of-anova">3. Aim and hypotheses of ANOVA</a></li>
  <li><a href="#underlying-assumptions-of-anova" id="toc-underlying-assumptions-of-anova" class="nav-link" data-scroll-target="#underlying-assumptions-of-anova"><strong>4. Underlying assumptions of ANOVA</strong></a></li>
  <li><a href="#data-transformation-log-scale" id="toc-data-transformation-log-scale" class="nav-link" data-scroll-target="#data-transformation-log-scale"><strong>5. Data Transformation (Log Scale)</strong></a></li>
  <li><a href="#alternative-approaches-to-anova" id="toc-alternative-approaches-to-anova" class="nav-link" data-scroll-target="#alternative-approaches-to-anova"><strong>6. Alternative Approaches to ANOVA</strong></a></li>
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests"><strong>7. Post-hoc Tests</strong></a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><strong>Discussion</strong></a></li>
  </ul></li>
  <li><a href="#attribution" id="toc-attribution" class="nav-link" data-scroll-target="#attribution">Attribution</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Global Rights Data</h1>
</div>



<div class="quarto-title-meta column-page-left">

    
  
    
  </div>
  


</header>


<section id="about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data">About the Data</h2>
<p>This dataset provides yearly, country-level information on LGBTQ+ rights, economic indicators, and education spending. The data is compiled from Our World in Data, with primary sources including Equaldex, the World Bank, and other open-access datasets.</p>
<section id="download" class="level3">
<h3 class="anchored" data-anchor-id="download">Download</h3>
<div class="button-container">
<p><a href="../../data/clean/globalrights.csv" download="" class="download-button"> Download CSV </a></p>
</div>
</section>
<section id="metadata" class="level3">
<h3 class="anchored" data-anchor-id="metadata">Metadata</h3>
<div class="description-grid">
<div class="field-label">
DOI
</div>
<div class="field-value">
TBD
</div>
<div class="field-label">
CSV Name
</div>
<div class="field-value">
globalrights.csv
</div>
<div class="field-label">
Dataset Characteristics
</div>
<div class="field-value">
Multivariate, Panel (Country-Year)
</div>
<div class="field-label">
Subject Area
</div>
<div class="field-value">
Human Rights, Public Policy, International Development
</div>
<div class="field-label">
Associated Tasks
</div>
<div class="field-value">
Classification, Regression, Comparative Analysis
</div>
<div class="field-label">
Feature Type
</div>
<div class="field-value">
Categorical, Float, Integer
</div>
<div class="field-label">
Instances
</div>
<div class="field-value">
2,184 country-year observations (91 countries × 24 years)
</div>
<div class="field-label">
Features
</div>
<div class="field-value">
10
</div>
<div class="field-label">
Has Missing Values?
</div>
<div class="field-value">
Yes
</div>
</div>
</section>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables">Variables</h3>
<div class="table-container">
<div class="styled-table">
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 53%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Role</th>
<th>Type</th>
<th>Description</th>
<th>Units</th>
<th>Missing Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>year</code></td>
<td>ID</td>
<td>Integer</td>
<td>Year the data was recorded</td>
<td>Year</td>
<td>No</td>
</tr>
<tr class="even">
<td><code>country</code></td>
<td>ID</td>
<td>String</td>
<td>Country name</td>
<td>-</td>
<td>No</td>
</tr>
<tr class="odd">
<td><code>country-code</code></td>
<td>ID</td>
<td>String</td>
<td>ISO 3-letter country code</td>
<td>-</td>
<td>No</td>
</tr>
<tr class="even">
<td><code>gdp-per-capita</code></td>
<td>Feature</td>
<td>Float</td>
<td>Gross Domestic Product per capita</td>
<td>International $</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>education-spending-gdp</code></td>
<td>Feature</td>
<td>Float</td>
<td>Government education spending as a percentage of GDP</td>
<td>%</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>same-sex-marriage</code></td>
<td>Target</td>
<td>Categorical</td>
<td>Legal status of same-sex marriage (e.g., Legal, Civil Union, Not Recognized)</td>
<td>-</td>
<td>No</td>
</tr>
<tr class="odd">
<td><code>lgbtq-censorship</code></td>
<td>Feature</td>
<td>Categorical</td>
<td>Whether LGBTQ+ content is censored or restricted</td>
<td>-</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>employment-discrimination</code></td>
<td>Feature</td>
<td>Categorical</td>
<td>Whether anti-discrimination protections exist for LGBTQ+ individuals in employment</td>
<td>-</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>gender-affirming-care</code></td>
<td>Feature</td>
<td>Categorical</td>
<td>Availability and legal access to gender-affirming healthcare</td>
<td>-</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>legal-gender</code></td>
<td>Feature</td>
<td>Categorical</td>
<td>Whether legal gender can be changed and under what conditions (e.g., self-ID, medical req.)</td>
<td>-</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Please Note: This analysis is still in progress.</strong></p>
</section>
<section id="key-features-of-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="key-features-of-the-dataset"><strong>Key Features of the Dataset</strong></h3>
<p>Each row represents a single country’s record for a specific year and includes information such as GDP per capita, education spending, and the legal status of various LGBTQ+ rights and protections.</p>
<ul>
<li><p><code>year</code>: Year of observation</p></li>
<li><p><code>country</code>, <code>country-code</code>: Country name and ISO code</p></li>
<li><p><code>gdp-per-capita</code>: GDP per capita (constant international-$)</p></li>
<li><p><code>education-spending-gdp</code>: Government expenditure on education (% of GDP)</p></li>
<li><p><code>same-sex-marriage</code>: Legal status of same-sex marriage</p></li>
<li><p><code>lgbtq-censorship</code>: Whether LGBTQ+ topics are censored</p></li>
<li><p><code>employment-discrimination</code>: Laws against discrimination in employment</p></li>
<li><p><code>gender-affirming-care</code>: Legal and medical access to gender-affirming care</p></li>
<li><p><code>legal-gender</code>: Rights around legal gender marker change</p></li>
</ul>
</section>
<section id="purpose-and-use-cases" class="level3">
<h3 class="anchored" data-anchor-id="purpose-and-use-cases"><strong>Purpose and Use Cases</strong></h3>
<p>This dataset is designed to support analysis of:</p>
<ul>
<li><p>Global trends in LGBTQ+ rights over time</p></li>
<li><p>Associations between legal protections and economic or educational indicators</p></li>
<li><p>Regional disparities in access to gender-affirming care and anti-discrimination laws</p></li>
<li><p>The relationship between policy environments and broader measures of social inclusion</p></li>
<li><p>Temporal changes in legal recognition of same-sex marriage and gender identity</p></li>
</ul>
<p>It enables cross-country comparisons and longitudinal studies using harmonized data from trusted open-access sources.</p>
</section>
</section>
<section id="case-study" class="level2">
<h2 class="anchored" data-anchor-id="case-study"><strong>Case Study</strong></h2>
<section id="objective" class="level3">
<h3 class="anchored" data-anchor-id="objective"><strong>Objective</strong></h3>
<p><strong>Do countries with different levels of legal recognition for same-sex marriage also differ in terms of their economic development?</strong></p>
<p>This case study explores whether there are statistically significant differences in GDP per capita across countries grouped by their legal recognition of same-sex marriage:</p>
<ul>
<li>Legal (full marriage equality)</li>
<li>Civil union or other partnership</li>
<li>Not Recognized</li>
</ul>
<p>Rather than implying causality, we use a one-way ANOVA (or an appropriate alternative based on assumption checks) to examine whether the average level of economic development differs significantly across these legal categories.</p>
<p>To do this, we apply one one-way ANOVA test (or an appropriate alternative test) to address the following question:</p>
<ul>
<li>Does marriage recognition status relate to national wealth?<br>
Tested using GDP per capita as the response variable.</li>
</ul>
</section>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis"><strong>Analysis</strong></h3>
<section id="loading-libraries" class="level4">
<h4 class="anchored" data-anchor-id="loading-libraries"><strong>Loading Libraries</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PMCMRplus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning-processing" class="level4">
<h4 class="anchored" data-anchor-id="data-cleaning-processing"><strong>1. Data Cleaning &amp; Processing</strong></h4>
<ul>
<li><p>Dropped countries with missing values for key variables (<code>gdp-per-capita</code>, <code>education-spending-gdp</code>, <code>same-sex-marriage</code>)</p></li>
<li><p>Converted text fields into consistent categories (e.g., combining “Unrecognized” and “Banned” into one group)</p></li>
<li><p>Created a new factor variable: <code>marriage_group</code> . Based on our analytical goal which is comparing countries that formally recognize, partially recognize, or do not recognize same-sex unions at all. We created these three different levels for <code>marriage_group</code> filed.</p></li>
<li><p>Filtered the dataset to include only one year per country to ensure independent observations across time</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>global_rights <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/clean/globalrights.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the last year overall in the dataset</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>last_year <span class="ot">&lt;-</span> <span class="fu">max</span>(global_rights<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  map each of the levels in same sex marriage </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">## into one of three standardized categories for analysis</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>cleaned_df <span class="ot">&lt;-</span> global_rights <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">==</span> last_year, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">same-sex-marriage</span><span class="st">`</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">marriage_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">same-sex-marriage</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Legal"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Foreign same-sex marriages recognized only"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">~</span> <span class="st">"Legal"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">same-sex-marriage</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Civil union or other partnership"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Unregistered cohabitation"</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">~</span> <span class="st">"Civil Union or Partnership"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">same-sex-marriage</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Banned"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Unrecognized"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Varies by region"</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">~</span> <span class="st">"Not Recognized"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"The dataset is filtered to the last year overall: "</span>, last_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-data-analysis-eda" class="level4">
<h4 class="anchored" data-anchor-id="exploratory-data-analysis-eda"><strong>2. Exploratory Data Analysis (EDA)</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_df, <span class="fu">aes</span>(<span class="at">x =</span> marriage_group, <span class="at">y =</span> <span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span>, <span class="at">color =</span> marriage_group)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"GDP per Capita by Marriage Recognition Group"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Marriage Group"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"GDP per Capita (Intl $)"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="globalrights_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Boxplot of GDP per Capita/Education Spending by Marriage Group</strong></p>
<p>This shows the distribution of GDP per capita/Education Spending for each group of countries based on how they recognize same-sex marriage. It helps identify differences in economic and education spending status across the three groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP per capita</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gdp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cleaned_df, <span class="fu">aes</span>(<span class="at">x =</span> marriage_group, <span class="at">y =</span> <span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"GDP per Capita by Same-Sex Marriage Status"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Marriage Group"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"GDP per Capita (Intl $)"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>(gdp_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="globalrights_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The exploratory data analysis reveals that countries recognizing same-sex marriage (either fully or through civil unions) tend to have similar GDP per capita distributions, with overlapping interquartile ranges. In contrast, countries that do not recognize same-sex marriage show noticeably lower GDP per capita and exhibit no overlap with the other two groups, along with a higher number of outliers, indicating greater variability. For education spending, the distributions across all three groups are much closer, with less pronounced differences. While the Not Recognized group again shows some outliers, they are fewer compared to the GDP per capita distribution. This suggests that while economic wealth varies more strongly with legal recognition status, education investment appears relatively stable across groups.</p>
<p><strong>Histogram of GDP per Capita (All Countries)</strong></p>
<p>These plots show the overall distributions of GDP per capita and education spending (% of GDP) across countries in the dataset. They allow us to assess the shape of each variable’s distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram for GDP per Capita</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>hist_gdp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cleaned_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of GDP per Capita"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"GDP per Capita (Intl $)"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count of Countries"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>hist_gdp </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="globalrights_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>From the histograms, we observe that GDP per capita is right-skewed, indicating that most countries have relatively low to moderate GDP levels, with a smaller number of countries exhibiting much higher GDP per capita. This suggests economic wealth is concentrated in a few high-income countries.<br>
</p>
</section>
<section id="aim-and-hypotheses-of-anova" class="level4">
<h4 class="anchored" data-anchor-id="aim-and-hypotheses-of-anova">3. Aim and hypotheses of ANOVA</h4>
<p>To examine whether economic indicators differ across countries based on their legal recognition of same-sex marriage, we conduct two one-way ANOVA tests. Each test evaluates whether the mean value of a numeric variable varies significantly across the three legal categories: Legal, Civil Union, and Not Recognized.</p>
<p><strong>1. ANOVA for GDP per Capita</strong></p>
<p>We test whether countries with different legal recognition statuses have significantly different mean GDP per capita.</p>
<ul>
<li><p>Null Hypothesis (H₀):<br>
<span class="math display">\[
\mu_{\text{GDP}}(\text{Legal}) = \mu_{\text{GDP}}(\text{Civil Union}) = \mu_{\text{GDP}}(\text{Not Recognized})
\]</span></p></li>
<li><p>Alternative Hypothesis (Hₐ):<br>
<span class="math display">\[
\text{At least one pair of group means for GDP per capita is different.}
\]</span></p></li>
</ul>
<p>These tests help determine whether economic wealth or public investment in education is associated with how countries legally recognize same-sex marriage.</p>
</section>
<section id="underlying-assumptions-of-anova" class="level4">
<h4 class="anchored" data-anchor-id="underlying-assumptions-of-anova"><strong>4. Underlying assumptions of ANOVA</strong></h4>
<section id="independence-of-observations" class="level5">
<h5 class="anchored" data-anchor-id="independence-of-observations"><strong>1. Independence of Observations</strong></h5>
<ul>
<li>Observations within and across groups must be independent.</li>
<li>In our case, this means that each country-year observation is independent of others.</li>
<li>This assumption is typically satisfied by the design of the dataset if no country appears more than once per year and data points are not clustered.</li>
<li>Please note that dataset includes only one year per country to ensure independent observations across time</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> cleaned_df <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, year, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count), country, year)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(duplicates) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No duplicate country-year combinations found. Independence assumption is satisfied."</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Some countries appear more than once in the same year. See the table below:"</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  duplicates <span class="sc">|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Country</span><span class="st">`</span> <span class="ot">=</span> country,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="ot">=</span> year,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Number of Entries</span><span class="st">`</span> <span class="ot">=</span> count</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Duplicate Country-Year Combinations"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"lcc"</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No duplicate country-year combinations found. Independence assumption is satisfied."</code></pre>
</div>
</div>
</section>
<section id="normality-of-residuals" class="level5">
<h5 class="anchored" data-anchor-id="normality-of-residuals"><strong>2. Normality of Residuals</strong></h5>
<ul>
<li>The residuals within each group (i.e., within Legal, Civil Union, and Not Recognized) should be approximately normally distributed.</li>
<li>We will assess this assumption using:
<ul>
<li>Histogram or Q-Q plots of the residuals</li>
<li>Shapiro-Wilk test for normality within each group</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP per capita - residuals within groups</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>gdp_residuals <span class="ot">&lt;-</span> cleaned_df <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(marriage_group) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_resid =</span> <span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span> <span class="sc">-</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Q-Q Plots for GDP Residuals</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gdp_residuals, <span class="fu">aes</span>(<span class="at">sample =</span> gdp_resid)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span>         </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>      </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>marriage_group) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Q-Q Plot of GDP per Capita Residuals"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sample Quantiles"</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="globalrights_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Shapiro-Wilk Test for Normality (All Groups)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP residuals by group</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>gdp_shapiro <span class="ot">&lt;-</span> gdp_residuals <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(marriage_group) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">shapiro.test</span>(gdp_resid)<span class="sc">$</span>p.value,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Group</span><span class="st">`</span> <span class="ot">=</span> marriage_group, <span class="st">`</span><span class="at">GDP Residuals p-value</span><span class="st">`</span> <span class="ot">=</span> p_value)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  gdp_shapiro,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Shapiro-Wilk Test Results for Normality of GDP Residuals"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Shapiro-Wilk Test Results for Normality of GDP Residuals</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: right;">GDP Residuals p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Civil Union or Partnership</td>
<td style="text-align: right;">0.0733833</td>
</tr>
<tr class="even">
<td style="text-align: left;">Legal</td>
<td style="text-align: right;">0.0726414</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Not Recognized</td>
<td style="text-align: right;">0.0000001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For GDP per capita, the Q-Q plot shows a clear deviation from the 45-degree line in the Not Recognized group, indicating that the residuals are not normally distributed. This is confirmed by the Shapiro-Wilk test, which returns p-values below 0.001 for all three marriage groups, leading us to reject the assumption of normality. As a result, the normality assumption for ANOVA is not satisfied for GDP per capita, and alternative approaches such as a log transformation, Welch’s ANOVA, or the Kruskal–Wallis test may be more appropriate.</p>
</section>
<section id="homogeneity-of-variances-homoscedasticity" class="level5">
<h5 class="anchored" data-anchor-id="homogeneity-of-variances-homoscedasticity"><strong>3. Homogeneity of Variances (Homoscedasticity)</strong></h5>
<ul>
<li>The variance of the response variable should be similar across all groups.</li>
<li>We will check this using:
<ul>
<li>Levene’s Test or Bartlett’s Test for equality of variances</li>
<li>Visual inspection via boxplots for any substantial differences in spread</li>
</ul></li>
</ul>
<p><strong>Levene’s and Bartlett’s Test for GDP per Capita</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP per capita</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>gdp_levene <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span> <span class="sc">~</span> marriage_group, <span class="at">data =</span> cleaned_df)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>gdp_bartlett <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span> <span class="sc">~</span> marriage_group, <span class="at">data =</span> cleaned_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The Results</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>homogeneity_results <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"GDP per Capita"</span>, <span class="st">"GDP per Capita"</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"Levene's Test"</span>, <span class="st">"Bartlett's Test"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Test Statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    gdp_levene<span class="sc">$</span><span class="st">`</span><span class="at">F value</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    gdp_bartlett<span class="sc">$</span>statistic</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    gdp_levene<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    gdp_bartlett<span class="sc">$</span>p.value</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  homogeneity_results,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Homogeneity of Variances for GDP per Capita: Levene’s and Bartlett’s Tests"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Homogeneity of Variances for GDP per Capita: Levene’s and Bartlett’s Tests</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Test</th>
<th style="text-align: right;">Test Statistic</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GDP per Capita</td>
<td style="text-align: left;">Levene’s Test</td>
<td style="text-align: right;">1.8638</td>
<td style="text-align: right;">0.1618</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP per Capita</td>
<td style="text-align: left;">Bartlett’s Test</td>
<td style="text-align: right;">6.5058</td>
<td style="text-align: right;">0.0387</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For GDP per capita, Levene’s test suggests that the assumption of equal variances is not violated (p = 0.1618), while Bartlett’s test indicates a violation (p = 0.0387). Since Bartlett’s test is more sensitive to deviations from normality, and the two tests disagree, caution should be used when interpreting the homogeneity of variances assumption for this variable.</p>
</section>
</section>
<section id="data-transformation-log-scale" class="level4">
<h4 class="anchored" data-anchor-id="data-transformation-log-scale"><strong>5. Data Transformation (Log Scale)</strong></h4>
<p>We applied a log transformation to GDP per capita and education spending to address violations of ANOVA assumptions. This transformation helps reduce right skewness and stabilize variance across groups, making the data more suitable for parametric tests like Welch’s ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cleaned_df <span class="ot">&lt;-</span> cleaned_df <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_gdp =</span> <span class="fu">log</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_edu =</span> <span class="fu">log</span>(<span class="st">`</span><span class="at">education-spending-gdp</span><span class="st">`</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_df, <span class="fu">aes</span>(<span class="at">sample =</span> log_gdp)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_qq</span>(<span class="at">color =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span>         </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>marriage_group) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Q-Q Plot of Log(GDP per Capita) Residuals by Group"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sample Quantiles"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="globalrights_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Shapiro-Wilk Test for Normality (All Groups) after Log Scale</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gdp_shapiro_log <span class="ot">&lt;-</span> cleaned_df <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(marriage_group) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">shapiro.test</span>(log_gdp)<span class="sc">$</span>p.value,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Group</span><span class="st">`</span> <span class="ot">=</span> marriage_group, <span class="st">`</span><span class="at">log(GDP) p-value</span><span class="st">`</span> <span class="ot">=</span> p_value)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  gdp_shapiro_log,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Shapiro-Wilk Test Results for Normality of Log-Transformed GDP per Capita"</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Shapiro-Wilk Test Results for Normality of Log-Transformed GDP per Capita</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: right;">log(GDP) p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Civil Union or Partnership</td>
<td style="text-align: right;">0.0014443</td>
</tr>
<tr class="even">
<td style="text-align: left;">Legal</td>
<td style="text-align: right;">0.0850579</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Not Recognized</td>
<td style="text-align: right;">0.4244092</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>levene_log_gdp <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(log_gdp <span class="sc">~</span> marriage_group, <span class="at">data =</span> cleaned_df)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>bartlett_log_gdp <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(log_gdp <span class="sc">~</span> marriage_group, <span class="at">data =</span> cleaned_df)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>log_gdp_variance_tests <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Log GDP per Capita"</span>, <span class="st">"Log GDP per Capita"</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"Levene’s Test"</span>, <span class="st">"Bartlett’s Test"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Test Statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    levene_log_gdp<span class="sc">$</span><span class="st">`</span><span class="at">F value</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    bartlett_log_gdp<span class="sc">$</span>statistic</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    levene_log_gdp<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    bartlett_log_gdp<span class="sc">$</span>p.value</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  log_gdp_variance_tests,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Homogeneity of Variances for Log GDP per Capita: Levene’s and Bartlett’s Tests"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Homogeneity of Variances for Log GDP per Capita: Levene’s and Bartlett’s Tests</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Test</th>
<th style="text-align: right;">Test Statistic</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Log GDP per Capita</td>
<td style="text-align: left;">Levene’s Test</td>
<td style="text-align: right;">9.7838</td>
<td style="text-align: right;">2e-04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Log GDP per Capita</td>
<td style="text-align: left;">Bartlett’s Test</td>
<td style="text-align: right;">17.4628</td>
<td style="text-align: right;">2e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Even after applying the log transformation, both Levene’s test (p = 0.0002) and Bartlett’s test (p = 0.0002) for log GDP per capita return very small p-values. This indicates that the assumption of equal variances is still violated.</p>
<p>Therefore, standard ANOVA remains inappropriate for analyzing differences in log GDP per capita across groups, and a more robust alternative should be considered.</p>
</section>
<section id="alternative-approaches-to-anova" class="level4">
<h4 class="anchored" data-anchor-id="alternative-approaches-to-anova"><strong>6. Alternative Approaches to ANOVA</strong></h4>
<section id="gdp-per-capita-kruskalwallis-test" class="level5">
<h5 class="anchored" data-anchor-id="gdp-per-capita-kruskalwallis-test"><strong>1. GDP per Capita: Kruskal–Wallis Test</strong></h5>
<p>Since the assumptions of normality and homogeneity of variances were both violated for GDP per capita, we applied the Kruskal–Wallis test, a non-parametric alternative to one-way ANOVA.</p>
<p>This test compares the distributions of the response variable across groups, rather than their means, and does not require normality or equal variances.</p>
<p>We chose this test because it is robust and appropriate when ANOVA assumptions are not met, particularly in the presence of skewed data and unequal variances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gdp_kw <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span> <span class="sc">~</span> marriage_group, <span class="at">data =</span> cleaned_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And this is our final result :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>final_gdp_test_result <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="st">"GDP per Capita"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="st">"Kruskal–Wallis"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Test Statistic</span><span class="st">`</span> <span class="ot">=</span> gdp_kw<span class="sc">$</span>statistic,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> gdp_kw<span class="sc">$</span>p.value</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  final_gdp_test_result,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Final Test Result for GDP per Capita: Kruskal–Wallis Test"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"lcc"</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Final Test Result for GDP per Capita: Kruskal–Wallis Test</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Test</th>
<th style="text-align: center;">Test Statistic</th>
<th style="text-align: left;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GDP per Capita</td>
<td style="text-align: center;">Kruskal–Wallis</td>
<td style="text-align: center;">37.6841</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For GDP per capita, the Kruskal–Wallis test returned a large test statistic (37.6841) with a p-value of 0, indicating a statistically significant difference in distributions across the three marriage recognition groups.</p>
<p>Since the Kruskal–Wallis test does not require normality or equal variances, this result provides strong evidence that at least one group differs in GDP distribution. This supports the conclusion that GDP per capita is associated with the legal recognition of same-sex marriage across countries.</p>
</section>
</section>
<section id="post-hoc-tests" class="level4">
<h4 class="anchored" data-anchor-id="post-hoc-tests"><strong>7. Post-hoc Tests</strong></h4>
<p>While our main tests (Kruskal–Wallis for GDP per capita and Welch’s ANOVA for education spending) showed that there are statistically significant differences across the marriage recognition groups, they do not specify which specific group pairs differ from each other. To gain a clearer understanding of where these differences lie such as whether countries recognizing same-sex marriage differ significantly from those offering only civil unions or no recognition we conducted post-hoc test.</p>
<section id="post-hoc-test-for-gdp-per-capita" class="level5">
<h5 class="anchored" data-anchor-id="post-hoc-test-for-gdp-per-capita"><strong>1. Post-hoc Test for GDP per Capita</strong></h5>
<p>Since we used the Kruskal–Wallis test (a non-parametric method) for GDP per capita, we followed it with Dunn’s test for post-hoc comparisons. The Kruskal–Wallis test tells us whether there’s a difference in distributions among the groups, but it does not tell us which pairs of groups differ. Dunn’s test fills that gap. What is Dunn’s Test? Dunn’s test performs pairwise comparisons between all levels of the grouping variable (in this case, marriage_group) using ranked data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gdp_posthoc <span class="ot">&lt;-</span> <span class="fu">dunnTest</span>(<span class="st">`</span><span class="at">gdp-per-capita</span><span class="st">`</span> <span class="sc">~</span> marriage_group, <span class="at">data =</span> cleaned_df, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>gdp_posthoc<span class="sc">$</span>res <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">round</span>(P.adj, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">Z Statistic</span><span class="st">`</span> <span class="ot">=</span> Z, <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p.adj) <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Dunn’s Post-hoc Test for GDP per Capita (Bonferroni Correction)"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"lcc"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">4</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Dunn’s Post-hoc Test for GDP per Capita (Bonferroni Correction)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Comparison</th>
<th style="text-align: center;">Z Statistic</th>
<th style="text-align: center;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Civil Union or Partnership - Legal</td>
<td style="text-align: center;">-1.8689</td>
<td style="text-align: center;">0.1849</td>
</tr>
<tr class="even">
<td style="text-align: left;">Civil Union or Partnership - Not Recognized</td>
<td style="text-align: center;">2.8144</td>
<td style="text-align: center;">0.0147</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Legal - Not Recognized</td>
<td style="text-align: center;">6.0984</td>
<td style="text-align: center;">0.0000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Dunn’s post-hoc test shows a significant difference in GDP per capita between countries that do not recognize same-sex marriage and those that do, either through legal marriage or civil unions. However, there is no significant difference between countries offering legal marriage and those offering civil unions, suggesting the economic gap lies primarily between recognition and non-recognition.</p>
</section>
</section>
</section>
<section id="discussion" class="level3">
<h3 class="anchored" data-anchor-id="discussion"><strong>Discussion</strong></h3>
<p>Countries that differ in their legal recognition of same-sex marriage also show significant differences in GDP per capita. Initial ANOVA assumption checks revealed clear violations of normality and homogeneity of variances for this variable. Even after applying a log transformation, these issues persisted, making standard ANOVA inappropriate.</p>
<p>As a result, we used the Kruskal–Wallis test, a non-parametric alternative that does not assume normality or equal variances. The test revealed highly significant group-level differences. Post-hoc analysis showed that countries not recognizing same-sex marriage have significantly lower GDP per capita than those offering civil unions or legal marriage, while no significant difference was found between the latter two.</p>
<p>These findings suggest a strong association between economic development and the legal recognition of same-sex marriage, with more economically developed countries being more likely to adopt inclusive legal frameworks.</p>
</section>
</section>
<section id="attribution" class="level2">
<h2 class="anchored" data-anchor-id="attribution">Attribution</h2>
<p>This analysis uses data compiled and curated from <strong>Our World in Data</strong>, an open-access initiative that aggregates global development indicators. The variables used in this analysis include economic and policy-related measures across 91 countries from 2000 to 2023.</p>
<p>Data sources include:</p>
<ul>
<li><strong>GDP per Capita</strong>: <a href="https://ourworldindata.org/economic-growth">Our World in Data – Economic Growth</a><br>
</li>
<li><strong>Education Spending (% of GDP)</strong>: <a href="https://ourworldindata.org/financing-education">Our World in Data – Education Expenditure</a><br>
</li>
<li><strong>LGBTQ+ Rights Indicators</strong>:
<ul>
<li><a href="https://ourworldindata.org/lgbt-rights">Same-Sex Marriage Laws</a><br>
</li>
<li><a href="https://ourworldindata.org/lgbt-rights">LGBTQ+ Censorship</a><br>
</li>
<li><a href="https://ourworldindata.org/lgbt-rights">Employment Discrimination Protections</a><br>
</li>
<li><a href="https://ourworldindata.org/lgbt-rights">Gender-Affirming Care Access</a><br>
</li>
<li><a href="https://ourworldindata.org/lgbt-rights">Legal Gender Recognition</a></li>
</ul></li>
</ul>
<p>All data is used under the terms of the <strong>Creative Commons BY license</strong>. Please refer to <a href="https://ourworldindata.org/licensing">Our World in Data – Licensing</a> for more details.</p>
<blockquote class="blockquote">
<p><strong>Citation</strong>:<br>
Our World in Data. Various datasets compiled and maintained by the Global Change Data Lab.<br>
<a href="https://ourworldindata.org">https://ourworldindata.org</a></p>
</blockquote>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>