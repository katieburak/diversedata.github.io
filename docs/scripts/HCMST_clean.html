<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Clean up for HCMST_2017-2022.csv – Diverse Data Hub</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../website_files/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Diverse Data Hub</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Welcome</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../website_files/datasets.html"> 
<span class="menu-text">Datasets</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Clean up for HCMST_2017-2022.csv</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../website_files/img/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/diverse-data-hub" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Datasets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://diverse-data-hub.github.io/website_files/description_pages/marchmadness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">March Madness</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://diverse-data-hub.github.io/website_files/description_pages/wildfire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wildfire</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">CRAN Page (TBD)</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/diverse-data-hub/diversedata/issues" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Report an Issue</span></a>
  </div>
</li>
        <li class="sidebar-item">
 <span class="menu-text">License (TBD)</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://diverse-data-hub.github.io/website_files/citation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Citation (TBD)</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Owners</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/katieburak" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Katie Burak PhD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/elhamekhoda" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elham E Khoda</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Collaborators</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/fraramfra" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Francisco Ramirez</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/AzinPiran" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Azin Piran</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/siddart-1" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Siddarth Subrahmanian</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clean up for HCMST_2017-2022.csv</h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<section id="loading-csv" class="level2">
<h2 class="anchored" data-anchor-id="loading-csv">Loading CSV</h2>
<p>Load the necessary libraries for the clean-up, as well as the provided dataset</p>
<div id="e2dd2f01-3781-4e8b-b0c3-9225ca797703" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5603811d-c98c-41b0-ba9b-aa2fd1043ca9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../data/raw/how-couples-meet-and-stay-together/HCMST_2017-2022.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">caseid_new</th>
<th data-quarto-table-cell-role="th">w3_Weight</th>
<th data-quarto-table-cell-role="th">w3_Weight_LGB</th>
<th data-quarto-table-cell-role="th">w3_combo_weight</th>
<th data-quarto-table-cell-role="th">w3_attrition_adj_weight</th>
<th data-quarto-table-cell-role="th">w2_weight_genpop</th>
<th data-quarto-table-cell-role="th">w2_weight_LGB</th>
<th data-quarto-table-cell-role="th">w2_combo_weight</th>
<th data-quarto-table-cell-role="th">w2_attrition_adj_weights</th>
<th data-quarto-table-cell-role="th">w1_weight_combo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">p20_pppa1634</th>
<th data-quarto-table-cell-role="th">p20_pppa1902</th>
<th data-quarto-table-cell-role="th">p20_pppa1903</th>
<th data-quarto-table-cell-role="th">p20_pppa1904</th>
<th data-quarto-table-cell-role="th">p20_ppp22001</th>
<th data-quarto-table-cell-role="th">p20_pppa1905</th>
<th data-quarto-table-cell-role="th">p20_pppa1648</th>
<th data-quarto-table-cell-role="th">p20_ppp20072</th>
<th data-quarto-table-cell-role="th">p20_ppp20071</th>
<th data-quarto-table-cell-role="th">p20_ppp2date2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>0.4422</td>
<td>NaN</td>
<td>0.495308</td>
<td>0.400185</td>
<td>0.3856</td>
<td>NaN</td>
<td>0.437670</td>
<td>0.380351</td>
<td>0.426861</td>
<td>...</td>
<td>2.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>13.0</td>
<td>6.0</td>
<td>NaN</td>
<td>20210506.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>0.8284</td>
<td>NaN</td>
<td>0.927891</td>
<td>0.879258</td>
<td>0.9196</td>
<td>NaN</td>
<td>1.043778</td>
<td>0.953948</td>
<td>1.295508</td>
<td>...</td>
<td>2.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>5.0</td>
<td>1.0</td>
<td>20201118.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>0.8255</td>
<td>NaN</td>
<td>0.924643</td>
<td>0.706467</td>
<td>0.7748</td>
<td>NaN</td>
<td>0.879425</td>
<td>0.724682</td>
<td>1.126573</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>20210429.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.9177</td>
<td>NaN</td>
<td>1.041622</td>
<td>0.793093</td>
<td>0.933440</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>11.0</td>
<td>2.0</td>
<td>1.0</td>
<td>20210507.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>0.8810</td>
<td>NaN</td>
<td>0.986809</td>
<td>0.655467</td>
<td>0.8697</td>
<td>NaN</td>
<td>0.987140</td>
<td>0.735473</td>
<td>0.931291</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>13.0</td>
<td>6.0</td>
<td>NaN</td>
<td>20210602.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 725 columns</p>
</div>
</div>
</div>
<div id="daa244e4-56e2-4887-b743-dce0fbd44c4c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>(3510, 725)</code></pre>
</div>
</div>
</section>
<section id="full-list-of-variables" class="level2">
<h2 class="anchored" data-anchor-id="full-list-of-variables">Full List of Variables</h2>
<p>The next cell displays the full list of variables in the original data set. We are not going to use everything…</p>
<p>We’ll focus on variables of interest for specific inquiries.</p>
<p>In the following links, we can find the encoding of each variable.</p>
<p>Data source: https://data.stanford.edu/hcmst2017</p>
<p>Variable List per year (Note w1 = 2017, w2 = 2020, w3 = 2022): https://stacks.stanford.edu/file/druid:tq903pj6286/HCMST%202017-%202022%20user%27s%20guide%20v2.3.pdf</p>
<p>Detailed Info on variables: https://stacks.stanford.edu/file/druid:hg921sg6829/HCMST%202017%20to%202022%20v2.2%20codebook.pdf</p>
<div id="e849d67d-9456-4368-b319-0cdad85ec0ce" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df.columns.tolist()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="variables-of-interest">Variables of Interest</h2>
<p>The following lists are not actually used in the rest of the notebook for data cleaning purposes.</p>
<p>Still, they display the selected variables of interest (and how their names vary from year to year), so, we are leaving them in the notebook for documentation.</p>
<div id="51f9c0d1-98bc-4980-9d03-ae294b25874c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ppage = Age</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ppeduc = Education (Highest Degree Received)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ppgender = Gender</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ppethm =  Race / Ethnicity </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ppincimp = Household Income</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ppwork = Current Employment Status </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>subject_demographics_2017 <span class="op">=</span> [</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppage'</span>, <span class="st">'w1_ppeduc'</span>, <span class="st">'w1_ppgender'</span>, <span class="st">'w1_ppethm'</span>, <span class="st">'w1_ppincimp'</span>, <span class="st">'w1_ppwork'</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>subject_demographics_2020 <span class="op">=</span> [</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppage'</span>, <span class="st">'w2_ppeduc'</span>, <span class="st">'w2_ppgender'</span>, <span class="st">'w2_ppethm'</span>, <span class="st">'w2_ppincimp'</span>, <span class="st">'w2_ppwork'</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>subject_demographics_2022 <span class="op">=</span> [</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppage'</span>, <span class="st">'w3_ppeduc'</span>, <span class="st">'w3_ppgender'</span>, <span class="st">'w3_ppethm'</span>, <span class="st">'w3_ppincimp'</span>, <span class="st">'w3_ppwork'</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7262d05a-f413-42bc-949b-06894e9d1796" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q4 = Partner Gender</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># q9 = Partner Age</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># q6b = Partner's Race</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># q10 = Partner's Education (Highest Degree Received)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>partner_demographics_2017 <span class="op">=</span> [</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q4'</span>, <span class="st">'w1_q9'</span>, <span class="st">'w1_q6b'</span>, <span class="st">'w1_q10'</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>partner_demographics_2020 <span class="op">=</span> [</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_Q4'</span>, <span class="st">'w2_Q9'</span>, <span class="st">'w2_Q6B'</span>, <span class="st">'w2_Q10'</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>partner_demographics_2022 <span class="op">=</span> [</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q4'</span>, <span class="st">'w3_Q9'</span>, <span class="st">'w3_Q6B'</span>, <span class="st">'w3_Q10'</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1601740c-d262-4515-ad0f-315459961de8" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same_sex_couple = same-sex couple</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># married = Married</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># q34/rel_qual_combo/rel_qual = Relationship quality 1 (Excellent) to 5 (Very Poor) - Potential Target</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>relationship_status_2017 <span class="op">=</span> [</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_same_sex_couple'</span>, <span class="st">'w1_married'</span>, <span class="st">'w1_q34'</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>relationship_status_2020 <span class="op">=</span> [</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_same_sex_couple'</span>, <span class="st">'w2_married'</span>, <span class="st">'w2_rel_qual_combo'</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>relationship_status_2022 <span class="op">=</span> [</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_same_sex_couple'</span>, <span class="st">'w3_married'</span>, <span class="st">'w3_rel_qual'</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="264447d4-ee0b-41e1-96ee-3360c0f04463" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q21b - Year current relationship started</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># q21d - Year of marriage</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># q21e - Year relationship ended</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># relate/relationship duration = Duration of relationship in years</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>relationship_time_2017 <span class="op">=</span> [</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q21b_year'</span>, <span class="st">'w1_q21d_year'</span>, <span class="st">'w1_q21e_year'</span>, <span class="st">'w1_relate_duration_in2017_years'</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>relationship_time_2020 <span class="op">=</span> [</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_q21b_year'</span>, <span class="st">'w2_q21d_year'</span>, <span class="st">'w2_q21e_year'</span>, <span class="st">'w2_relationship_duration'</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>relationship_time_2022 <span class="op">=</span> [</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q21B_year'</span>, <span class="st">'w3_Q21D_year'</span>, <span class="st">'w3_Q21E_year'</span>, <span class="st">'w3_relationship_duration_yrs'</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3203e3f4-412a-490f-89f3-45f3491c381f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PPT01 = # of children in the household ages 0-1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># PPT25 = # of children in the household ages 2-5</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># PPT612 = # of children in the household ages 6-12</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PPT1317 = # of children in the household ages 13-17</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># PPT18OV = # of children in the household ages 18-Over</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>children_info_2017 <span class="op">=</span> [</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_PPT01'</span>, <span class="st">'w1_PPT25'</span>, <span class="st">'w1_PPT612'</span>, <span class="st">'w1_PPT1317'</span>, <span class="st">'w1_PPT18OV'</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>children_info_2020 <span class="op">=</span> [</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_PPT01'</span>, <span class="st">'w2_PPT25'</span>, <span class="st">'w2_PPT612'</span>, <span class="st">'w2_PPT1317'</span>, <span class="st">'w2_PPT18OV'</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>children_info_2022 <span class="op">=</span> [</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_PPT01'</span>, <span class="st">'w3_PPT25'</span>, <span class="st">'w3_PPT612'</span>, <span class="st">'w3_PPT1317'</span>, <span class="st">'w3_PPT18OV'</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c37894a0-5b16-44f5-b4fb-1493ef818425" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only available in 2022 in full (Post-COVID)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># coronavirus_effect_combo = Is relationship better or worse during pandemic</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pandemic_income = has income gone up or down during pandemic</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># subject/partner_had_COVID = has been sick with COVID</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># corona/partner_vaccine = has been vaccinated</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># COVID_agreement = subject and partner agree on approach to pandemic</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>covid_vars_2022 <span class="op">=</span> [</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_coronavirus_effect_combo'</span>, <span class="st">'w3_pandemic_income'</span>, <span class="st">'w3_subject_had_COVID'</span>, <span class="st">'w3_partner_had_COVID'</span>, <span class="st">'w3_corona_vaccine'</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_partner_corona_vaccine'</span>, <span class="st">'w3_COVID_agreement'</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a5f83264-bb19-4984-8aec-b6bea3522538" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only some variables available per year</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sex_frequency = Frequency of sex</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># flirt = how often flirt</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fight = how often fight</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># monogamy = subject's commitment to monogamy</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p_monogamy = expected commitment to monogamy from partner</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>relationship_quality_2017 <span class="op">=</span> [</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_sex_frequency'</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>relationship_quality_2020 <span class="op">=</span> [</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_sex_frequency'</span>, <span class="st">'w2_flirt'</span>, <span class="st">'w2_fight'</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>relationship_quality_2022 <span class="op">=</span> [</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_sex_frequency'</span>, <span class="st">'w3_flirt'</span>, <span class="st">'w3_fight'</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rename-columns" class="level2">
<h2 class="anchored" data-anchor-id="rename-columns">Rename Columns</h2>
<p>Some variables contain the same information but vary in name year to year. So, we’ll need 3 renaming dictionaries (1 per year)</p>
<p>First, the 3 renaming maps (one per year):</p>
<div id="3de59e5e-69e7-4777-b8d5-4fdb79710216" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>column_renames_2017 <span class="op">=</span> {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#subject_demographics</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppage'</span>: <span class="st">'subject_age'</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppeduc'</span>: <span class="st">'subject_education'</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppgender'</span>: <span class="st">'subject_sex'</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppethm'</span>: <span class="st">'subject_ethnicity'</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppincimp'</span>: <span class="st">'subject_income_category'</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_ppwork'</span>: <span class="st">'subject_employment_status'</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#partner_demographics</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q4'</span>: <span class="st">'partner_sex'</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q9'</span>: <span class="st">'partner_age'</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q6b'</span>: <span class="st">'partner_ethnicity'</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q10'</span>: <span class="st">'partner_education'</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_status</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_same_sex_couple'</span>: <span class="st">'same_sex_couple'</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_married'</span>: <span class="st">'married'</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q34'</span>: <span class="st">'relationship_quality'</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_time</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q21b_year'</span>: <span class="st">'relationship_start_year'</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q21d_year'</span>: <span class="st">'marriage_year'</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_q21e_year'</span>: <span class="st">'break_up_year'</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_relate_duration_in2017_years'</span>: <span class="st">'relationship_duration'</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#children_info</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_PPT01'</span>: <span class="st">'kids_0_1'</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_PPT25'</span>: <span class="st">'kids_2_5'</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_PPT612'</span>: <span class="st">'kids_6_12'</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_PPT1317'</span>: <span class="st">'kids_13_17'</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_PPT18OV'</span>: <span class="st">'kids_18_plus'</span>,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#covidvars</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_coronavirus_effect_combo': 'rel_change_during_pandemic',</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_pandemic_income': 'inc_change_during_pandemic',</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_subject_had_COVID': 'subject_had_covid', </span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_partner_had_COVID': 'partner_had_covid', </span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_corona_vaccine': 'subject_vaccinated',</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_partner_corona_vaccine': 'partner_vaccinated', </span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w1_COVID_agreement': 'agree_covid_approach',</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_quality</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w1_sex_frequency'</span>: <span class="st">'sex_frequency'</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w3_flirt': 'flirts_with_partner',</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w3_fight': 'fights_with_partner',</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7ce0f740-9bbf-436e-a44b-be4acc50e935" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>column_renames_2020 <span class="op">=</span> {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#subject_demographics</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppage'</span>: <span class="st">'subject_age'</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppeduc'</span>: <span class="st">'subject_education'</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppgender'</span>: <span class="st">'subject_sex'</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppethm'</span>: <span class="st">'subject_ethnicity'</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppincimp'</span>: <span class="st">'subject_income_category'</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_ppwork'</span>: <span class="st">'subject_employment_status'</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#partner_demographics</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_Q4'</span>: <span class="st">'partner_sex'</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_Q9'</span>: <span class="st">'partner_age'</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_Q6B'</span>: <span class="st">'partner_ethnicity'</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_Q10'</span>: <span class="st">'partner_education'</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_status</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_same_sex_couple'</span>: <span class="st">'same_sex_couple'</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_married'</span>: <span class="st">'married'</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_rel_qual_combo'</span>: <span class="st">'relationship_quality'</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_time</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_q21b_year'</span>: <span class="st">'relationship_start_year'</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_q21d_year'</span>: <span class="st">'marriage_year'</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_q21e_year'</span>: <span class="st">'break_up_year'</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_relationship_duration'</span>: <span class="st">'relationship_duration'</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#children_info</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_PPT01'</span>: <span class="st">'kids_0_1'</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_PPT25'</span>: <span class="st">'kids_2_5'</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_PPT612'</span>: <span class="st">'kids_6_12'</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_PPT1317'</span>: <span class="st">'kids_13_17'</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_PPT18OV'</span>: <span class="st">'kids_18_plus'</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#covidvars</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_coronavirus_effect_combo': 'rel_change_during_pandemic',</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_pandemic_income': 'inc_change_during_pandemic',</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_subject_had_COVID': 'subject_had_covid', </span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_partner_had_COVID': 'partner_had_covid', </span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_corona_vaccine': 'subject_vaccinated',</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_partner_corona_vaccine': 'partner_vaccinated', </span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'w2_COVID_agreement': 'agree_covid_approach',</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_quality</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_sex_frequency'</span>: <span class="st">'sex_frequency'</span>,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_flirt'</span>: <span class="st">'flirts_with_partner'</span>,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w2_fight'</span>: <span class="st">'fights_with_partner'</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5e03f2ce-9a1d-47a3-8531-b0842a05203d" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>column_renames_2022 <span class="op">=</span> {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#subject_demographics</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppage'</span>: <span class="st">'subject_age'</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppeduc'</span>: <span class="st">'subject_education'</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppgender'</span>: <span class="st">'subject_sex'</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppethm'</span>: <span class="st">'subject_ethnicity'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppincimp'</span>: <span class="st">'subject_income_category'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_ppwork'</span>: <span class="st">'subject_employment_status'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#partner_demographics</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q4'</span>: <span class="st">'partner_sex'</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q9'</span>: <span class="st">'partner_age'</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q6B'</span>: <span class="st">'partner_ethnicity'</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q10'</span>: <span class="st">'partner_education'</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_status</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_same_sex_couple'</span>: <span class="st">'same_sex_couple'</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_married'</span>: <span class="st">'married'</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_rel_qual'</span>: <span class="st">'relationship_quality'</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_time</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q21B_year'</span>: <span class="st">'relationship_start_year'</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q21D_year'</span>: <span class="st">'marriage_year'</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_Q21E_year'</span>: <span class="st">'break_up_year'</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_relationship_duration_yrs'</span>: <span class="st">'relationship_duration'</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#children_info</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_PPT01'</span>: <span class="st">'kids_0_1'</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_PPT25'</span>: <span class="st">'kids_2_5'</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_PPT612'</span>: <span class="st">'kids_6_12'</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_PPT1317'</span>: <span class="st">'kids_13_17'</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_PPT18OV'</span>: <span class="st">'kids_18_plus'</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#covidvars</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_coronavirus_effect_combo'</span>: <span class="st">'rel_change_during_pandemic'</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_pandemic_income'</span>: <span class="st">'inc_change_during_pandemic'</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_subject_had_COVID'</span>: <span class="st">'subject_had_covid'</span>, </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_partner_had_COVID'</span>: <span class="st">'partner_had_covid'</span>, </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_corona_vaccine'</span>: <span class="st">'subject_vaccinated'</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_partner_corona_vaccine'</span>: <span class="st">'partner_vaccinated'</span>, </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_COVID_agreement'</span>: <span class="st">'agree_covid_approach'</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#relationship_quality</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_sex_frequency'</span>: <span class="st">'sex_frequency'</span>,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_flirt'</span>: <span class="st">'flirts_with_partner'</span>,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'w3_fight'</span>: <span class="st">'fights_with_partner'</span>,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dataframe-per-year" class="level3">
<h3 class="anchored" data-anchor-id="dataframe-per-year">Dataframe per year</h3>
<p>We need to create dataframes per year while renaming variables in each dictionary.</p>
<p>We will also create a column named “Wave” that contains the year of the survey.</p>
<p>First, 2017:</p>
<div id="8394f51e-34e9-41da-ba46-1de1b3773036" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_2017 <span class="op">=</span> df[[<span class="st">'caseid_new'</span>] <span class="op">+</span> <span class="bu">list</span>(column_renames_2017.keys())].rename(columns<span class="op">=</span>column_renames_2017)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df_2017[<span class="st">'wave'</span>] <span class="op">=</span> <span class="st">'2017'</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>df_2017.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">caseid_new</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">marriage_year</th>
<th data-quarto-table-cell-role="th">break_up_year</th>
<th data-quarto-table-cell-role="th">relationship_duration</th>
<th data-quarto-table-cell-role="th">kids_0_1</th>
<th data-quarto-table-cell-role="th">kids_2_5</th>
<th data-quarto-table-cell-role="th">kids_6_12</th>
<th data-quarto-table-cell-role="th">kids_13_17</th>
<th data-quarto-table-cell-role="th">kids_18_plus</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">wave</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>48</td>
<td>9</td>
<td>2</td>
<td>5</td>
<td>13</td>
<td>1</td>
<td>1.0</td>
<td>46.0</td>
<td>1.0</td>
<td>...</td>
<td>2014.0</td>
<td>NaN</td>
<td>3.583333</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3.0</td>
<td>2017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>68</td>
<td>10</td>
<td>2</td>
<td>1</td>
<td>12</td>
<td>1</td>
<td>1.0</td>
<td>71.0</td>
<td>1.0</td>
<td>...</td>
<td>1969.0</td>
<td>NaN</td>
<td>52.750000</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>5.0</td>
<td>2017</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>39</td>
<td>11</td>
<td>1</td>
<td>1</td>
<td>15</td>
<td>1</td>
<td>2.0</td>
<td>49.0</td>
<td>1.0</td>
<td>...</td>
<td>2002.0</td>
<td>NaN</td>
<td>17.583334</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>3.0</td>
<td>2017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>54</td>
<td>9</td>
<td>1</td>
<td>1</td>
<td>16</td>
<td>1</td>
<td>2.0</td>
<td>59.0</td>
<td>4.0</td>
<td>...</td>
<td>1991.0</td>
<td>NaN</td>
<td>27.416666</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>4.0</td>
<td>2017</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>48</td>
<td>10</td>
<td>1</td>
<td>1</td>
<td>14</td>
<td>1</td>
<td>2.0</td>
<td>34.0</td>
<td>1.0</td>
<td>...</td>
<td>2013.0</td>
<td>2014.0</td>
<td>NaN</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>NaN</td>
<td>2017</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
<div id="14c1541d-5ef9-4601-a423-6562923669f8" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_2017.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(3510, 25)</code></pre>
</div>
</div>
<p>Then, 2020:</p>
<div id="70daa5b2-1e95-499c-9878-1856856d562b" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_2020 <span class="op">=</span> df[[<span class="st">'caseid_new'</span>] <span class="op">+</span> <span class="bu">list</span>(column_renames_2020.keys())].rename(columns<span class="op">=</span>column_renames_2020)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_2020[<span class="st">'wave'</span>] <span class="op">=</span> <span class="st">'2020'</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df_2020.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">caseid_new</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">relationship_duration</th>
<th data-quarto-table-cell-role="th">kids_0_1</th>
<th data-quarto-table-cell-role="th">kids_2_5</th>
<th data-quarto-table-cell-role="th">kids_6_12</th>
<th data-quarto-table-cell-role="th">kids_13_17</th>
<th data-quarto-table-cell-role="th">kids_18_plus</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">wave</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>51.0</td>
<td>9.0</td>
<td>2.0</td>
<td>1.0</td>
<td>10.0</td>
<td>1.0</td>
<td>1.0</td>
<td>51.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>5.0</td>
<td>6.0</td>
<td>1.0</td>
<td>2020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>71.0</td>
<td>10.0</td>
<td>2.0</td>
<td>1.0</td>
<td>13.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>56.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>5.0</td>
<td>6.0</td>
<td>4.0</td>
<td>2020</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>42.0</td>
<td>11.0</td>
<td>1.0</td>
<td>1.0</td>
<td>15.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>21.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>3.0</td>
<td>3.0</td>
<td>2.0</td>
<td>3.0</td>
<td>2020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>57.0</td>
<td>9.0</td>
<td>1.0</td>
<td>1.0</td>
<td>16.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>31.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>4.0</td>
<td>6.0</td>
<td>1.0</td>
<td>2020</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>52.0</td>
<td>10.0</td>
<td>1.0</td>
<td>1.0</td>
<td>18.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020</td>
</tr>
</tbody>
</table>

<p>5 rows × 27 columns</p>
</div>
</div>
</div>
<div id="3230b36c-3185-4612-8dcc-b0ed752f1977" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_2020.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(3510, 27)</code></pre>
</div>
</div>
<p>Then, 2022:</p>
<div id="bf17ce4e-5eda-430e-8293-47f24b9085ca" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_2022 <span class="op">=</span> df[[<span class="st">'caseid_new'</span>] <span class="op">+</span> <span class="bu">list</span>(column_renames_2022.keys())].rename(columns<span class="op">=</span>column_renames_2022)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df_2022[<span class="st">'wave'</span>] <span class="op">=</span> <span class="st">'2022'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_2022.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">caseid_new</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">wave</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>53.0</td>
<td>9.0</td>
<td>2.0</td>
<td>1.0</td>
<td>10.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>3.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1.0</td>
<td>3.0</td>
<td>2.0</td>
<td>1.0</td>
<td>2022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>72.0</td>
<td>10.0</td>
<td>2.0</td>
<td>1.0</td>
<td>14.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>2.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>5.0</td>
<td>6.0</td>
<td>8.0</td>
<td>2022</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>43.0</td>
<td>11.0</td>
<td>1.0</td>
<td>1.0</td>
<td>14.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>2.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>3.0</td>
<td>2.0</td>
<td>3.0</td>
<td>2022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>53.0</td>
<td>10.0</td>
<td>1.0</td>
<td>1.0</td>
<td>18.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>3.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022</td>
</tr>
</tbody>
</table>

<p>5 rows × 34 columns</p>
</div>
</div>
</div>
<div id="60dc5d7f-7255-4424-826d-f500e3a62dd8" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_2022.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(3510, 34)</code></pre>
</div>
</div>
</section>
</section>
<section id="a-single-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="a-single-dataframe">A single Dataframe</h2>
<p>Now, we can concatenate the 3 dataframes since they have the same variables. We’ll have the “wave” column to differentiate by year.</p>
<div id="af49a30c-da89-4a55-992b-af688504c919" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_cleaned <span class="op">=</span> pd.concat([df_2017, df_2020, df_2022], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e3d2883c-ba17-447b-8805-118f77c09486" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>(10530, 34)</code></pre>
</div>
</div>
<div id="2caa1181-a711-4304-9ccd-e4ebbbcb52ab" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">caseid_new</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">wave</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">rel_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>48.0</td>
<td>9.0</td>
<td>2.0</td>
<td>5.0</td>
<td>13.0</td>
<td>1.0</td>
<td>1.0</td>
<td>46.0</td>
<td>1.0</td>
<td>...</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>68.0</td>
<td>10.0</td>
<td>2.0</td>
<td>1.0</td>
<td>12.0</td>
<td>1.0</td>
<td>1.0</td>
<td>71.0</td>
<td>1.0</td>
<td>...</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>39.0</td>
<td>11.0</td>
<td>1.0</td>
<td>1.0</td>
<td>15.0</td>
<td>1.0</td>
<td>2.0</td>
<td>49.0</td>
<td>1.0</td>
<td>...</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>54.0</td>
<td>9.0</td>
<td>1.0</td>
<td>1.0</td>
<td>16.0</td>
<td>1.0</td>
<td>2.0</td>
<td>59.0</td>
<td>4.0</td>
<td>...</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>48.0</td>
<td>10.0</td>
<td>1.0</td>
<td>1.0</td>
<td>14.0</td>
<td>1.0</td>
<td>2.0</td>
<td>34.0</td>
<td>1.0</td>
<td>...</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>5 rows × 34 columns</p>
</div>
</div>
</div>
<p>We are just going to rename the ‘caseid_new’ to something more simple:</p>
<div id="1e0a5f3c-4e44-4130-91b7-9d4590e20526" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_cleaned <span class="op">=</span> df_cleaned.rename(columns<span class="op">=</span>{<span class="st">'caseid_new'</span>: <span class="st">'id'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="selected-variables" class="level3">
<h3 class="anchored" data-anchor-id="selected-variables">Selected variables</h3>
<div id="29300d9c-c55c-4113-b443-fddee70a0f94" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.columns.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>['id',
 'subject_age',
 'subject_education',
 'subject_sex',
 'subject_ethnicity',
 'subject_income_category',
 'subject_employment_status',
 'partner_sex',
 'partner_age',
 'partner_ethnicity',
 'partner_education',
 'same_sex_couple',
 'married',
 'relationship_quality',
 'relationship_start_year',
 'marriage_year',
 'break_up_year',
 'relationship_duration',
 'kids_0_1',
 'kids_2_5',
 'kids_6_12',
 'kids_13_17',
 'kids_18_plus',
 'sex_frequency',
 'wave',
 'flirts_with_partner',
 'fights_with_partner',
 'rel_change_during_pandemic',
 'inc_change_during_pandemic',
 'subject_had_covid',
 'partner_had_covid',
 'subject_vaccinated',
 'partner_vaccinated',
 'agree_covid_approach']</code></pre>
</div>
</div>
<p>Merging kids of all ages to a single feature:</p>
<div id="7ec579b6-5753-42ea-a845-1ee51ea1e76d" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'children'</span>] <span class="op">=</span> df_cleaned[<span class="st">'kids_0_1'</span>] <span class="op">+</span> df_cleaned[<span class="st">'kids_2_5'</span>] <span class="op">+</span> df_cleaned[<span class="st">'kids_6_12'</span>] <span class="op">+</span> df_cleaned[<span class="st">'kids_13_17'</span>] <span class="op">+</span> df_cleaned[<span class="st">'kids_18_plus'</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df_cleaned.drop(columns<span class="op">=</span>[<span class="st">'kids_0_1'</span>, <span class="st">'kids_2_5'</span>, <span class="st">'kids_6_12'</span>, <span class="st">'kids_13_17'</span>, <span class="st">'kids_18_plus'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5170234d-1ee3-40f6-9d3b-fc1c80725b7a" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">rel_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
<th data-quarto-table-cell-role="th">children</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>48.0</td>
<td>9.0</td>
<td>2.0</td>
<td>5.0</td>
<td>13.0</td>
<td>1.0</td>
<td>1.0</td>
<td>46.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>68.0</td>
<td>10.0</td>
<td>2.0</td>
<td>1.0</td>
<td>12.0</td>
<td>1.0</td>
<td>1.0</td>
<td>71.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>39.0</td>
<td>11.0</td>
<td>1.0</td>
<td>1.0</td>
<td>15.0</td>
<td>1.0</td>
<td>2.0</td>
<td>49.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>54.0</td>
<td>9.0</td>
<td>1.0</td>
<td>1.0</td>
<td>16.0</td>
<td>1.0</td>
<td>2.0</td>
<td>59.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>48.0</td>
<td>10.0</td>
<td>1.0</td>
<td>1.0</td>
<td>14.0</td>
<td>1.0</td>
<td>2.0</td>
<td>34.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 30 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="data-type-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-type-exploration">Data Type Exploration</h2>
<p>We can see what data type each column has. We can note that all columns are encoded with numerical values.</p>
<div id="6dd4af6b-7a6d-4c5e-9226-3b0e28accc57" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>id                              int64
subject_age                   float64
subject_education             float64
subject_sex                   float64
subject_ethnicity             float64
subject_income_category       float64
subject_employment_status     float64
partner_sex                   float64
partner_age                   float64
partner_ethnicity             float64
partner_education             float64
same_sex_couple               float64
married                       float64
relationship_quality          float64
relationship_start_year       float64
marriage_year                 float64
break_up_year                 float64
relationship_duration         float64
sex_frequency                 float64
wave                           object
flirts_with_partner           float64
fights_with_partner           float64
rel_change_during_pandemic    float64
inc_change_during_pandemic    float64
subject_had_covid             float64
partner_had_covid             float64
subject_vaccinated            float64
partner_vaccinated            float64
agree_covid_approach          float64
children                      float64
dtype: object</code></pre>
</div>
</div>
</section>
<section id="decoding-variables" class="level2">
<h2 class="anchored" data-anchor-id="decoding-variables">Decoding Variables</h2>
<p>We’ll need to re-map column content to something more interpretable.</p>
<p>Going column by column…</p>
<p>First, education level:</p>
<div id="ca911e75-5626-4158-a652-0b340463473b" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>edu_mapping <span class="op">=</span> {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'no_education'</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'1st_4th_grade'</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'5th_6th_grade'</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'7th_8th_grade'</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'9th'</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'10th'</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'11th'</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="st">'12th_nodiploma'</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>: <span class="st">'high_school_grad'</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>: <span class="st">'some_college'</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>: <span class="st">'associate_degree'</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>: <span class="st">'bach_degree'</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">13</span>: <span class="st">'masters_degree'</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">14</span>: <span class="st">'prof_doct_degree'</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_education'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_education'</span>].<span class="bu">map</span>(edu_mapping)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'partner_education'</span>] <span class="op">=</span> df_cleaned[<span class="st">'partner_education'</span>].<span class="bu">map</span>(edu_mapping)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>ordered_levels <span class="op">=</span> [</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'no_education'</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'1st_4th_grade'</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'5th_6th_grade'</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'7th_8th_grade'</span>,</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'9th'</span>,</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'10th'</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'11th'</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'12th_nodiploma'</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'high_school_grad'</span>,</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'some_college'</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'associate_degree'</span>,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bach_degree'</span>,</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'masters_degree'</span>,</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'prof_doct_degree'</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to ordered categorical</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_education'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    df_cleaned[<span class="st">'subject_education'</span>],</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>ordered_levels,</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'partner_education'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    df_cleaned[<span class="st">'partner_education'</span>],</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>ordered_levels,</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then gender:</p>
<div id="1ff479f6-f994-4ddf-b721-6aa22558cb0c" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gender_mapping <span class="op">=</span> {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'male'</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'female'</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'other'</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_sex'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_sex'</span>].<span class="bu">map</span>(gender_mapping)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'partner_sex'</span>] <span class="op">=</span> df_cleaned[<span class="st">'partner_sex'</span>].<span class="bu">map</span>(gender_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, ethniticy/race:</p>
<div id="3de65f77-5739-4ba4-b5c9-9adae676ef1a" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>eth_sub_mapping <span class="op">=</span> {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'white'</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'black'</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'other'</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'hispanic'</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'2_plus_eth'</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_ethnicity'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_ethnicity'</span>].<span class="bu">map</span>(eth_sub_mapping)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>eth_part_mapping <span class="op">=</span> {</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'white'</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'black'</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'american_indian'</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'asian'</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'other'</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'partner_ethnicity'</span>] <span class="op">=</span> df_cleaned[<span class="st">'partner_ethnicity'</span>].<span class="bu">map</span>(eth_part_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, income level:</p>
<div id="a9a3caf7-6662-4bbd-a859-0cd4d7c0b7de" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>income_mapping <span class="op">=</span> {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'under_5k'</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'5k_7k'</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'7k_10k'</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'10k_12k'</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'12k_15k'</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'15k_20k'</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'20k_25k'</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="st">'25k_30k'</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>: <span class="st">'30k_35k'</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>: <span class="st">'35k_40k'</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>: <span class="st">'40k_50k'</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>: <span class="st">'50k_60k'</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">13</span>: <span class="st">'60k_75k'</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">14</span>: <span class="st">'75k_85k'</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>: <span class="st">'85k_100k'</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">16</span>: <span class="st">'100k_125k'</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">17</span>: <span class="st">'125k_150k'</span>,</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">18</span>: <span class="st">'150k_175k'</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">19</span>: <span class="st">'175k_200k'</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>: <span class="st">'200k_250k'</span>,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">21</span>: <span class="st">'over_250k'</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_income_category'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_income_category'</span>].<span class="bu">map</span>(income_mapping)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>ordered_income_levels <span class="op">=</span> [</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'under_5k'</span>, <span class="st">'5k_7k'</span>, <span class="st">'7k_10k'</span>, <span class="st">'10k_12k'</span>, <span class="st">'12k_15k'</span>, <span class="st">'15k_20k'</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'20k_25k'</span>, <span class="st">'25k_30k'</span>, <span class="st">'30k_35k'</span>, <span class="st">'35k_40k'</span>, <span class="st">'40k_50k'</span>, <span class="st">'50k_60k'</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'60k_75k'</span>, <span class="st">'75k_85k'</span>, <span class="st">'85k_100k'</span>, <span class="st">'100k_125k'</span>, <span class="st">'125k_150k'</span>,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'150k_175k'</span>, <span class="st">'175k_200k'</span>, <span class="st">'200k_250k'</span>, <span class="st">'over_250k'</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_income_category'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    df_cleaned[<span class="st">'subject_income_category'</span>],</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>ordered_income_levels,</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, employment status:</p>
<div id="e4007e81-ebb8-4fe3-bfd3-cf23d90be4f6" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>employment_mapping <span class="op">=</span> {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'working_paid_employee'</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'working_self_employed'</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'not_working_temp_layoff'</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'not_working_looking'</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'not_working_retired'</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'not_working_disabled'</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'not_working_other'</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_employment_status'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_employment_status'</span>].<span class="bu">map</span>(employment_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, same-sex couple encoding:</p>
<div id="d8d9d217-8b43-4220-af5f-bcc325a2a9ce" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>same_sex_couple_map <span class="op">=</span> {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'no'</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'yes'</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'same_sex_couple'</span>] <span class="op">=</span> df_cleaned[<span class="st">'same_sex_couple'</span>].<span class="bu">map</span>(same_sex_couple_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, marital status:</p>
<div id="323ffbb4-9f33-42de-a6d7-da354c62a1de" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>married_mapping <span class="op">=</span> {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'not_married'</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'married'</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'married'</span>] <span class="op">=</span> df_cleaned[<span class="st">'married'</span>].<span class="bu">map</span>(married_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, relationship quality <strong>(THIS COULD BE A TARGET VARIABLE FOR MANY STUDIES)</strong>:</p>
<div id="38632a9b-a73e-4f46-a226-f8beded2fb56" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rel_qual_mapping <span class="op">=</span> {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'excellent'</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'good'</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'fair'</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'poor'</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'very_poor'</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'relationship_quality'</span>] <span class="op">=</span> df_cleaned[<span class="st">'relationship_quality'</span>].<span class="bu">map</span>(rel_qual_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, the effect of COVID on the relationship. Note that all COVID variables only appear in the 2022 survey.</p>
<div id="797ff8b1-10f3-4613-b9fe-d1e1b8f764fb" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>covid_effect_mapping <span class="op">=</span> {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'better_than_before'</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'no_change'</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'worse_than_before'</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'rel_change_during_pandemic'</span>] <span class="op">=</span> df_cleaned[<span class="st">'rel_change_during_pandemic'</span>].<span class="bu">map</span>(covid_effect_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, the effect of COVID on income level.</p>
<div id="d6c036f4-e8bb-4b7d-8c6b-59590af0bbf1" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>covid_income_mapping <span class="op">=</span> {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'much_worse'</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'worse'</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'no_change'</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'better'</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'much_better'</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'inc_change_during_pandemic'</span>] <span class="op">=</span> df_cleaned[<span class="st">'inc_change_during_pandemic'</span>].<span class="bu">map</span>(covid_income_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, if subject or partner had COVID</p>
<div id="e7f2a38c-65d1-4ace-8758-5ad3601a00c0" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>had_covid_mapping <span class="op">=</span> {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'no'</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'yes'</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_had_covid'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_had_covid'</span>].<span class="bu">map</span>(had_covid_mapping)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'partner_had_covid'</span>] <span class="op">=</span> df_cleaned[<span class="st">'partner_had_covid'</span>].<span class="bu">map</span>(had_covid_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, status of COVID vaccination:</p>
<div id="e12c67cc-b8cb-47b0-8079-159bd768d533" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>corona_vaccine_mapping <span class="op">=</span> {</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'fully_vaccinated_and_booster'</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'fully_vaccinated_no_booster'</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'partially_vaccinated'</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'not_vaccinated'</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'subject_vaccinated'</span>] <span class="op">=</span> df_cleaned[<span class="st">'subject_vaccinated'</span>].<span class="bu">map</span>(corona_vaccine_mapping)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'partner_vaccinated'</span>] <span class="op">=</span> df_cleaned[<span class="st">'partner_vaccinated'</span>].<span class="bu">map</span>(corona_vaccine_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, if the couple agrees on COVID approach:</p>
<div id="5d0afa62-0847-4677-bc88-db61b3f22e0d" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>covid_agreement_mapping <span class="op">=</span> {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'completely_agree'</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'mostly_agree'</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'mostly_disagree'</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'completely_disagree'</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'agree_covid_approach'</span>] <span class="op">=</span> df_cleaned[<span class="st">'agree_covid_approach'</span>].<span class="bu">map</span>(covid_agreement_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, sex frequency:</p>
<div id="d70cf4b8-e688-41de-ab78-9c6f5fab4bf9" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>sex_frequency_mapping <span class="op">=</span> {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'once_or_more_a_day'</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'3_to_6_times_a_week'</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'once_or_twice_a_week'</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'2_to_3_times_a_month'</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'once_a_month_or_less'</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'sex_frequency'</span>] <span class="op">=</span> df_cleaned[<span class="st">'sex_frequency'</span>].<span class="bu">map</span>(sex_frequency_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, how often the subject flirts with partner:</p>
<div id="fc804daa-6394-425b-96ce-08cb67ce0229" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>flirt_mapping <span class="op">=</span> {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'every_day'</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'a_few_times_a_week'</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'once_a_week'</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'1_to_3_times_a_month'</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'less_than_once_a_month'</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'never'</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'flirts_with_partner'</span>] <span class="op">=</span> df_cleaned[<span class="st">'flirts_with_partner'</span>].<span class="bu">map</span>(flirt_mapping)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>ordered_flirt_frequency_levels <span class="op">=</span> [</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'every_day'</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'a_few_times_a_week'</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'once_a_week'</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'1_to_3_times_a_month'</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'less_than_once_a_month'</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'never'</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'flirts_with_partner'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    df_cleaned[<span class="st">'flirts_with_partner'</span>],</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>ordered_flirt_frequency_levels,</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, how often the subject fights with partner:</p>
<div id="9a916646-9a20-4196-b9a0-d1e24e0c598f" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fight_mapping <span class="op">=</span> {</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'0_times'</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'1_time'</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'2_times'</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'3_times'</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'4_times'</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'5_times'</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'6_times'</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="st">'7_or_more_times'</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'fights_with_partner'</span>] <span class="op">=</span> df_cleaned[<span class="st">'fights_with_partner'</span>].<span class="bu">map</span>(fight_mapping)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>ordered_fight_frequency_levels <span class="op">=</span> [</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'0_times'</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'1_time'</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'2_times'</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'3_times'</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'4_times'</span>,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'5_times'</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'6_times'</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'7_or_more_times'</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'fights_with_partner'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    df_cleaned[<span class="st">'fights_with_partner'</span>],</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>ordered_fight_frequency_levels,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can see the updated data types for each variable.</p>
<p>We can also see a sample of how the data looks after the recoding process.</p>
<div id="f045d64f-0675-4dc0-b613-401913aa2450" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>id                               int64
subject_age                    float64
subject_education             category
subject_sex                     object
subject_ethnicity               object
subject_income_category       category
subject_employment_status       object
partner_sex                     object
partner_age                    float64
partner_ethnicity               object
partner_education             category
same_sex_couple                 object
married                         object
relationship_quality            object
relationship_start_year        float64
marriage_year                  float64
break_up_year                  float64
relationship_duration          float64
sex_frequency                   object
wave                            object
flirts_with_partner           category
fights_with_partner           category
rel_change_during_pandemic      object
inc_change_during_pandemic      object
subject_had_covid               object
partner_had_covid               object
subject_vaccinated              object
partner_vaccinated              object
agree_covid_approach            object
children                       float64
dtype: object</code></pre>
</div>
</div>
<div id="3ef8cc46-eb2c-48e2-a6b6-a519208196d7" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.sample(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">partner_education</th>
<th data-quarto-table-cell-role="th">same_sex_couple</th>
<th data-quarto-table-cell-role="th">married</th>
<th data-quarto-table-cell-role="th">relationship_quality</th>
<th data-quarto-table-cell-role="th">relationship_start_year</th>
<th data-quarto-table-cell-role="th">marriage_year</th>
<th data-quarto-table-cell-role="th">break_up_year</th>
<th data-quarto-table-cell-role="th">relationship_duration</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">wave</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">rel_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
<th data-quarto-table-cell-role="th">children</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1835</td>
<td>2317447</td>
<td>43.0</td>
<td>bach_degree</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>44.0</td>
<td>white</td>
<td>associate_degree</td>
<td>no</td>
<td>married</td>
<td>excellent</td>
<td>2012.0</td>
<td>2013.0</td>
<td>NaN</td>
<td>5.500000</td>
<td>once_or_twice_a_week</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1203</td>
<td>1974471</td>
<td>70.0</td>
<td>masters_degree</td>
<td>female</td>
<td>white</td>
<td>30k_35k</td>
<td>not_working_retired</td>
<td>male</td>
<td>74.0</td>
<td>white</td>
<td>high_school_grad</td>
<td>no</td>
<td>not_married</td>
<td>NaN</td>
<td>1986.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3656</td>
<td>813467</td>
<td>63.0</td>
<td>bach_degree</td>
<td>female</td>
<td>white</td>
<td>60k_75k</td>
<td>not_working_retired</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>no</td>
<td>married</td>
<td>excellent</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>41.000000</td>
<td>once_a_month_or_less</td>
<td>2020</td>
<td>1_to_3_times_a_month</td>
<td>2_times</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1657</td>
<td>2228497</td>
<td>27.0</td>
<td>high_school_grad</td>
<td>male</td>
<td>white</td>
<td>30k_35k</td>
<td>not_working_disabled</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4525</td>
<td>1902763</td>
<td>62.0</td>
<td>associate_degree</td>
<td>male</td>
<td>white</td>
<td>20k_25k</td>
<td>working_paid_employee</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>not_married</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1888</td>
<td>2338241</td>
<td>38.0</td>
<td>12th_nodiploma</td>
<td>male</td>
<td>white</td>
<td>35k_40k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>37.0</td>
<td>white</td>
<td>high_school_grad</td>
<td>no</td>
<td>married</td>
<td>excellent</td>
<td>1996.0</td>
<td>2000.0</td>
<td>NaN</td>
<td>20.916666</td>
<td>once_or_twice_a_week</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6896</td>
<td>2948877</td>
<td>62.0</td>
<td>high_school_grad</td>
<td>male</td>
<td>white</td>
<td>25k_30k</td>
<td>not_working_retired</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>no</td>
<td>married</td>
<td>good</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>46.000000</td>
<td>once_a_month_or_less</td>
<td>2020</td>
<td>never</td>
<td>1_time</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2260</td>
<td>2565397</td>
<td>69.0</td>
<td>bach_degree</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>not_working_retired</td>
<td>female</td>
<td>65.0</td>
<td>asian</td>
<td>some_college</td>
<td>no</td>
<td>married</td>
<td>good</td>
<td>1971.0</td>
<td>1973.0</td>
<td>NaN</td>
<td>45.583332</td>
<td>once_a_month_or_less</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6693</td>
<td>2913341</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7264</td>
<td>1018305</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6925</td>
<td>2954057</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10239</td>
<td>2920753</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9129</td>
<td>2463691</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10255</td>
<td>2922621</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2022</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">773</td>
<td>1760115</td>
<td>64.0</td>
<td>high_school_grad</td>
<td>female</td>
<td>white</td>
<td>15k_20k</td>
<td>not_working_retired</td>
<td>male</td>
<td>55.0</td>
<td>white</td>
<td>high_school_grad</td>
<td>no</td>
<td>not_married</td>
<td>excellent</td>
<td>2011.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.333333</td>
<td>once_or_twice_a_week</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2141</td>
<td>2482081</td>
<td>38.0</td>
<td>bach_degree</td>
<td>male</td>
<td>hispanic</td>
<td>150k_175k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>38.0</td>
<td>white</td>
<td>masters_degree</td>
<td>no</td>
<td>married</td>
<td>excellent</td>
<td>1999.0</td>
<td>2003.0</td>
<td>NaN</td>
<td>17.833334</td>
<td>once_or_twice_a_week</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">341</td>
<td>1181693</td>
<td>68.0</td>
<td>high_school_grad</td>
<td>male</td>
<td>white</td>
<td>100k_125k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>67.0</td>
<td>white</td>
<td>some_college</td>
<td>no</td>
<td>married</td>
<td>excellent</td>
<td>1973.0</td>
<td>1974.0</td>
<td>NaN</td>
<td>43.916668</td>
<td>once_or_twice_a_week</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6629</td>
<td>2899207</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9325</td>
<td>2591515</td>
<td>70.0</td>
<td>some_college</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>no</td>
<td>married</td>
<td>good</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>38.416668</td>
<td>once_or_twice_a_week</td>
<td>2022</td>
<td>never</td>
<td>2_times</td>
<td>no_change</td>
<td>worse</td>
<td>no</td>
<td>no</td>
<td>fully_vaccinated_and_booster</td>
<td>fully_vaccinated_and_booster</td>
<td>completely_agree</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2138</td>
<td>2480385</td>
<td>55.0</td>
<td>associate_degree</td>
<td>male</td>
<td>hispanic</td>
<td>30k_35k</td>
<td>working_paid_employee</td>
<td>male</td>
<td>57.0</td>
<td>white</td>
<td>associate_degree</td>
<td>yes</td>
<td>not_married</td>
<td>good</td>
<td>1990.0</td>
<td>NaN</td>
<td>NaN</td>
<td>27.083334</td>
<td>once_a_month_or_less</td>
<td>2017</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="nan-percentage" class="level2">
<h2 class="anchored" data-anchor-id="nan-percentage">NaN Percentage</h2>
<p>Below we can note the % of NaN values in each column.</p>
<p>We can note that most columns still has a major % of NaN values.</p>
<p>These high percentages are mostly dependent on the year of the survey.</p>
<p>For example:</p>
<ul>
<li>2017 is missing primarily COVID related info.</li>
<li>2020 is missing primarily partner info, chronological info and COVID related info.</li>
<li>2022 is missing primarily partner info and chronological info.</li>
</ul>
<p>This makes sense as the documentation notes that:</p>
<ul>
<li>Variables in survey changed from year to year slightly.</li>
<li>“Response rate was 3510/6753=52% in 2017, 2107/2431= 87% in 2020, and 1722/2073=83% in 2022. The Denominators in 2020 and 2022 include only subjects who remained in the KnowledgePanel, as they were the only subjects eligible to be contacted.”</li>
</ul>
<div id="42da64d4-6d3d-4586-b73e-f5ab29e59087" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>(10530, 30)</code></pre>
</div>
</div>
<div id="c981c09e-8439-4439-be32-d2f7c3bcc4db" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>nan_percentage_per_column <span class="op">=</span> df_cleaned.isna().mean() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nan_percentage_per_column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>id                             0.000000
subject_age                   30.303894
subject_education             30.303894
subject_sex                   30.303894
subject_ethnicity             30.303894
subject_income_category       30.303894
subject_employment_status     30.303894
partner_sex                   65.536562
partner_age                   65.707502
partner_ethnicity             65.660019
partner_education             65.622032
same_sex_couple               39.563153
married                       31.405508
relationship_quality          44.586895
relationship_start_year       66.666667
marriage_year                 79.116809
break_up_year                 96.077873
relationship_duration         46.087369
sex_frequency                 47.853751
wave                           0.000000
flirts_with_partner           70.940171
fights_with_partner           71.975309
rel_change_during_pandemic    87.388414
inc_change_during_pandemic    83.741690
subject_had_covid             83.732194
partner_had_covid             86.904084
subject_vaccinated            83.817664
partner_vaccinated            87.245964
agree_covid_approach          87.435897
children                      30.303894
dtype: float64</code></pre>
</div>
</div>
<div id="c8362348-b267-48a6-a0e0-44fc7dd7bb75" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>nan_percentage_per_column_by_wave <span class="op">=</span> (</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    df_cleaned</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'wave'</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(<span class="kw">lambda</span> g: g.isna().mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    .transpose()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nan_percentage_per_column_by_wave)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>wave                              2017        2020       2022
id                            0.000000    0.000000   0.000000
subject_age                   0.000000   39.971510  50.940171
subject_education             0.000000   39.971510  50.940171
subject_sex                   0.000000   39.971510  50.940171
subject_ethnicity             0.000000   39.971510  50.940171
subject_income_category       0.000000   39.971510  50.940171
subject_employment_status     0.000000   39.971510  50.940171
partner_sex                   3.390313   95.868946  97.350427
partner_age                   3.874644   95.868946  97.378917
partner_ethnicity             3.732194   95.897436  97.350427
partner_education             3.618234   95.897436  97.350427
same_sex_couple               3.304843   53.475783  61.908832
married                       3.304843   39.971510  50.940171
relationship_quality         18.888889   52.962963  61.908832
relationship_start_year       6.666667   95.925926  97.407407
marriage_year                38.205128   99.658120  99.487179
break_up_year                88.319088   99.943020  99.971510
relationship_duration        21.225071   54.045584  62.991453
sex_frequency                23.475783   55.897436  64.188034
wave                          0.000000    0.000000   0.000000
flirts_with_partner         100.000000   51.225071  61.595442
fights_with_partner         100.000000   53.589744  62.336182
rel_change_during_pandemic  100.000000  100.000000  62.165242
inc_change_during_pandemic  100.000000  100.000000  51.225071
subject_had_covid           100.000000  100.000000  51.196581
partner_had_covid           100.000000  100.000000  60.712251
subject_vaccinated          100.000000  100.000000  51.452991
partner_vaccinated          100.000000  100.000000  61.737892
agree_covid_approach        100.000000  100.000000  62.307692
children                      0.000000   39.971510  50.940171</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Paco\AppData\Local\Temp\ipykernel_56416\437808906.py:4: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: g.isna().mean() * 100)</code></pre>
</div>
</div>
<p>We can remove some of the rows that are fully empty (even if they have values in “id” and “wave”)</p>
<div id="65432a6f-113a-401f-9d5e-85b0660026c3" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cols_to_check <span class="op">=</span> df_cleaned.columns.difference([<span class="st">'id'</span>, <span class="st">'wave'</span>])</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df_cleaned <span class="op">=</span> df_cleaned.dropna(subset<span class="op">=</span>cols_to_check, how<span class="op">=</span><span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1f407b5e-41e9-4f0d-bf6d-38927a1c86f1" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>(7339, 30)</code></pre>
</div>
</div>
<div id="f593b64c-d225-4cfe-a106-4006ab7f00a7" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>nan_percentage_per_column_by_wave <span class="op">=</span> (</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    df_cleaned</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'wave'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(<span class="kw">lambda</span> g: g.isna().mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    .transpose()</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nan_percentage_per_column_by_wave)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>wave                              2017        2020       2022
id                            0.000000    0.000000   0.000000
subject_age                   0.000000    0.000000   0.000000
subject_education             0.000000    0.000000   0.000000
subject_sex                   0.000000    0.000000   0.000000
subject_ethnicity             0.000000    0.000000   0.000000
subject_income_category       0.000000    0.000000   0.000000
subject_employment_status     0.000000    0.000000   0.000000
partner_sex                   3.390313   93.118178  94.599303
partner_age                   3.874644   93.118178  94.657375
partner_ethnicity             3.732194   93.165638  94.599303
partner_education             3.618234   93.165638  94.599303
same_sex_couple               3.304843   22.496440  22.357724
married                       3.304843    0.000000   0.000000
relationship_quality         18.888889   21.642145  22.357724
relationship_start_year       6.666667   93.213099  94.715447
marriage_year                38.205128   99.430470  98.954704
break_up_year                88.319088   99.905078  99.941928
relationship_duration        21.225071   23.445657  24.564460
sex_frequency                23.475783   26.530612  27.003484
wave                          0.000000    0.000000   0.000000
flirts_with_partner         100.000000   18.747034  21.718931
fights_with_partner         100.000000   22.686284  23.228804
rel_change_during_pandemic  100.000000  100.000000  22.880372
inc_change_during_pandemic  100.000000  100.000000   0.580720
subject_had_covid           100.000000  100.000000   0.522648
partner_had_covid           100.000000  100.000000  19.918699
subject_vaccinated          100.000000  100.000000   1.045296
partner_vaccinated          100.000000  100.000000  22.009292
agree_covid_approach        100.000000  100.000000  23.170732
children                      0.000000    0.000000   0.000000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Paco\AppData\Local\Temp\ipykernel_56416\437808906.py:4: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda g: g.isna().mean() * 100)</code></pre>
</div>
</div>
</section>
<section id="final-reorganization-of-columns" class="level2">
<h2 class="anchored" data-anchor-id="final-reorganization-of-columns">Final Reorganization of Columns</h2>
<p>Giving amount of missing data, “Partner variables” and “Chronological variables” that have significant %NaN rates in 2020 and 2022 could be removed for specific inquiries. However, I would propose to keep them in the overall dataset.</p>
<p>Therefore, the final data set would be:</p>
<div id="80f5401e-af90-482c-9d67-69a0c241dbaa" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Index(['id', 'subject_age', 'subject_education', 'subject_sex',
       'subject_ethnicity', 'subject_income_category',
       'subject_employment_status', 'partner_sex', 'partner_age',
       'partner_ethnicity', 'partner_education', 'same_sex_couple', 'married',
       'relationship_quality', 'relationship_start_year', 'marriage_year',
       'break_up_year', 'relationship_duration', 'sex_frequency', 'wave',
       'flirts_with_partner', 'fights_with_partner',
       'rel_change_during_pandemic', 'inc_change_during_pandemic',
       'subject_had_covid', 'partner_had_covid', 'subject_vaccinated',
       'partner_vaccinated', 'agree_covid_approach', 'children'],
      dtype='object')</code></pre>
</div>
</div>
<div id="c0258fdf-3a05-44b9-9a10-0bb079ceb985" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> df_cleaned[[<span class="st">'id'</span>, <span class="st">'wave'</span>,  <span class="co">#Identifiers</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'subject_age'</span>, <span class="st">'subject_education'</span>, <span class="st">'subject_sex'</span>,  <span class="co">#Subject variables</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'subject_ethnicity'</span>, <span class="st">'subject_income_category'</span>, <span class="st">'subject_employment_status'</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'partner_sex'</span>, <span class="st">'partner_age'</span>, <span class="st">'partner_ethnicity'</span>, <span class="st">'partner_education'</span>,  <span class="co">#Partner variables</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'same_sex_couple'</span>, <span class="st">'married'</span>, <span class="st">'sex_frequency'</span>, <span class="st">'flirts_with_partner'</span>, <span class="st">'fights_with_partner'</span>, <span class="co">#Couple Habits</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'relationship_start_year'</span>, <span class="st">'marriage_year'</span>, <span class="st">'break_up_year'</span>, <span class="co">#Chronology</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'relationship_duration'</span>, </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'children'</span>,  <span class="co">#Kids Info</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'rel_change_during_pandemic'</span>, <span class="st">'inc_change_during_pandemic'</span>, <span class="co">#Pandemic Vars</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'subject_had_covid'</span>, <span class="st">'partner_had_covid'</span>, <span class="st">'subject_vaccinated'</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'partner_vaccinated'</span>, <span class="st">'agree_covid_approach'</span>, </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'relationship_quality'</span> <span class="co">#Outcome</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>       ]]</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">wave</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">partner_education</th>
<th data-quarto-table-cell-role="th">same_sex_couple</th>
<th data-quarto-table-cell-role="th">married</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">relationship_start_year</th>
<th data-quarto-table-cell-role="th">marriage_year</th>
<th data-quarto-table-cell-role="th">break_up_year</th>
<th data-quarto-table-cell-role="th">relationship_duration</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">rel_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
<th data-quarto-table-cell-role="th">relationship_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>2017</td>
<td>48.0</td>
<td>high_school_grad</td>
<td>female</td>
<td>2_plus_eth</td>
<td>60k_75k</td>
<td>working_paid_employee</td>
<td>male</td>
<td>46.0</td>
<td>white</td>
<td>associate_degree</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>NaN</td>
<td>NaN</td>
<td>2013.0</td>
<td>2014.0</td>
<td>NaN</td>
<td>3.583333</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>2017</td>
<td>68.0</td>
<td>some_college</td>
<td>female</td>
<td>white</td>
<td>50k_60k</td>
<td>working_paid_employee</td>
<td>male</td>
<td>71.0</td>
<td>white</td>
<td>some_college</td>
<td>no</td>
<td>married</td>
<td>once_a_month_or_less</td>
<td>NaN</td>
<td>NaN</td>
<td>1964.0</td>
<td>1969.0</td>
<td>NaN</td>
<td>52.750000</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>2017</td>
<td>39.0</td>
<td>associate_degree</td>
<td>male</td>
<td>white</td>
<td>85k_100k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>49.0</td>
<td>white</td>
<td>some_college</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>NaN</td>
<td>NaN</td>
<td>1999.0</td>
<td>2002.0</td>
<td>NaN</td>
<td>17.583334</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>2017</td>
<td>54.0</td>
<td>high_school_grad</td>
<td>male</td>
<td>white</td>
<td>100k_125k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>59.0</td>
<td>asian</td>
<td>masters_degree</td>
<td>no</td>
<td>married</td>
<td>2_to_3_times_a_month</td>
<td>NaN</td>
<td>NaN</td>
<td>1990.0</td>
<td>1991.0</td>
<td>NaN</td>
<td>27.416666</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>2017</td>
<td>48.0</td>
<td>some_college</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>34.0</td>
<td>white</td>
<td>associate_degree</td>
<td>no</td>
<td>not_married</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011.0</td>
<td>2013.0</td>
<td>2014.0</td>
<td>NaN</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="final-data-review" class="level2">
<h2 class="anchored" data-anchor-id="final-data-review">Final Data Review</h2>
<div id="abe56a53-c263-4065-a472-984dad8b7d71" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> df_cleaned.columns:</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Column: </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Data type: </span><span class="sc">{</span>df_cleaned[column]<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Unique values: </span><span class="sc">{</span>df_cleaned[column]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Column: id
Data type: int64
Unique values: [  53001   71609  106983 ... 2968971 2969933 2972135]

Column: subject_age
Data type: float64
Unique values: [48. 68. 39. 54. 59. 72. 55. 73. 46. 43. 57. 50. 61. 79. 58. 64. 81. 70.
 80. 53. 51. 74. 56. 40. 36. 22. 47. 78. 67. 25. 65. 38. 24. 66. 35. 26.
 60. 71. 27. 29. 34. 76. 21. 41. 28. 19. 49. 86. 20. 23. 44. 84. 62. 63.
 45. 52. 77. 75. 42. 82. 69. 92. 85. 32. 37. 33. 30. 31. 90. 83. 18. 87.
 93. 89. 91. 88. 95. 97. 98.]

Column: subject_education
Data type: category
Unique values: ['high_school_grad', 'some_college', 'associate_degree', 'bach_degree', 'masters_degree', ..., '11th', '7th_8th_grade', '1st_4th_grade', 'no_education', '5th_6th_grade']
Length: 14
Categories (14, object): ['no_education' &lt; '1st_4th_grade' &lt; '5th_6th_grade' &lt; '7th_8th_grade' ... 'associate_degree' &lt; 'bach_degree' &lt; 'masters_degree' &lt; 'prof_doct_degree']

Column: subject_sex
Data type: object
Unique values: ['female' 'male']

Column: subject_ethnicity
Data type: object
Unique values: ['2_plus_eth' 'white' 'black' 'other' 'hispanic']

Column: subject_income_category
Data type: category
Unique values: ['60k_75k', '50k_60k', '85k_100k', '100k_125k', '75k_85k', ..., '15k_20k', '20k_25k', 'under_5k', '7k_10k', '5k_7k']
Length: 21
Categories (21, object): ['under_5k' &lt; '5k_7k' &lt; '7k_10k' &lt; '10k_12k' ... '150k_175k' &lt; '175k_200k' &lt; '200k_250k' &lt; 'over_250k']

Column: subject_employment_status
Data type: object
Unique values: ['working_paid_employee' 'not_working_disabled' 'not_working_retired'
 'not_working_looking' 'working_self_employed' 'not_working_other'
 'not_working_temp_layoff']

Column: partner_sex
Data type: object
Unique values: ['male' 'female' nan 'other']

Column: partner_age
Data type: float64
Unique values: [46. 71. 49. 59. 34. 52. 75. 55. 79. 37. 63. 51. 61. 62. 74. 50. 65. 58.
 83. 47. 70. 77. 42. 69. 24. 53. 56. 54. 57. 32. 44. 72. 28. 64. 30. nan
 33. 60. 43. 25. 27. 31. 80. 21. 78. 67. 29. 40. 39. 76. 23. 41. 45. 82.
 26. 66. 68. 86. 36. 84. 18. 20. 38. 73. 19. 81. 22. 91. 85. 48. -1. 87.
 89. 35. 10. 90. 94. 95. 17. 14. 16. 11.]

Column: partner_ethnicity
Data type: object
Unique values: ['white' 'asian' 'black' 'american_indian' 'other' nan]

Column: partner_education
Data type: category
Unique values: ['associate_degree', 'some_college', 'masters_degree', 'bach_degree', 'high_school_grad', ..., '7th_8th_grade', '10th', 'no_education', '5th_6th_grade', '1st_4th_grade']
Length: 15
Categories (14, object): ['no_education' &lt; '1st_4th_grade' &lt; '5th_6th_grade' &lt; '7th_8th_grade' ... 'associate_degree' &lt; 'bach_degree' &lt; 'masters_degree' &lt; 'prof_doct_degree']

Column: same_sex_couple
Data type: object
Unique values: ['no' nan 'yes']

Column: married
Data type: object
Unique values: ['married' 'not_married' nan]

Column: relationship_quality
Data type: object
Unique values: ['excellent' nan 'good' 'fair' 'very_poor' 'poor']

Column: relationship_start_year
Data type: float64
Unique values: [2013. 1964. 1999. 1990. 2011. 1993. 1981. 1983. 1996. 2001. 2014. 1984.
 1987. 1988. 1962. 1989. 1954. 1970. 2007.   nan 1960. 2015. 1978. 2006.
 2016. 1991. 1986. 1997. 2010. 2017. 1968. 1998. 1980. 2004. 1982. 1972.
 2002. 1977. 2008. 1974. 1985. 1994. 1979. 2009. 1959. 1965. 2012. 1971.
 1976. 1961. 1958. 1995. 1969. 1953. 1973. 2003. 1992. 2000. 1967. 1966.
 1963. 2005. 1975. 1955. 1952. 1947. 1957. 1951. 1950. 1956. 1948. 1949.
 1942. 2020. 2019. 2018. 1920. 2021. 2022.]

Column: marriage_year
Data type: float64
Unique values: [2014. 1969. 2002. 1991. 2013. 1997.   nan 1983. 2017. 2001. 1990. 2007.
 1964. 1985. 1984. 1956. 1995. 1972. 2008. 1960. 1986. 2000. 2009. 1987.
 1965. 1978. 1970. 2011. 1973. 2006. 1975. 1981. 1977. 1963. 1988. 1980.
 1976. 1999. 1992. 1996. 1961. 1974. 1994. 1955. 2016. 2003. 1982. 1998.
 1971. 1989. 1979. 1966. 2005. 1962. 1967. 1968. 2010. 2015. 2004. 1993.
 1959. 2012. 1951. 1952. 1957. 1958. 1950. 1944. 1948. 1953. 2019. 2018.
 2020. 2022. 2021.]

Column: break_up_year
Data type: float64
Unique values: [  nan 2014. 1989. 1985. 1984. 2016. 2017. 2012. 2013. 2015. 2007. 2006.
 2003. 2009. 1996. 2000. 1999. 2010. 1987. 1990. 1976. 2001. 1994. 1997.
 1978. 2004. 1992. 1975. 2011. 2002. 2008. 1986. 1993. 1980. 1995. 1988.
 1998. 1977. 2005. 1983. 1991. 2018. 2020. 2022.]

Column: relationship_duration
Data type: float64
Unique values: [ 3.58333325e+00  5.27500000e+01  1.75833340e+01  2.74166660e+01
             nan  2.35833340e+01  3.42500000e+01  2.36666660e+01
  2.10000000e+01  1.64166660e+01  3.41666675e+00  3.34166679e+01
  2.98333340e+01  2.89166660e+01  2.67500000e+01  2.80000000e+01
  3.59166679e+01  6.29166679e+01  2.45000000e+01  2.44166660e+01
  4.70833321e+01  1.03333330e+01  1.77500000e+01  1.66666663e+00
  3.89166679e+01  1.80833340e+01  1.09166670e+01  3.58333321e+01
  2.40833340e+01  2.88333340e+01  2.80833340e+01  2.65000000e+01
  3.43333321e+01  3.11666660e+01  2.75000000e+00  5.83333349e+00
  5.66666651e+00  1.95833340e+01  5.26666679e+01  3.95000000e+01
  4.90833321e+01  6.41666651e+00  1.91666660e+01  3.65833321e+01
  1.33333330e+01  3.47500000e+01  4.53333321e+01  1.46666670e+01
  3.99166679e+01  9.16666698e+00  4.25833321e+01  3.18333340e+01
  2.30000000e+01  3.81666679e+01  4.02500000e+01  1.15000000e+01
  3.90833321e+01  4.93333321e+01  8.16666698e+00  3.02500000e+01
  5.78333321e+01  5.15833321e+01  5.16666651e+00  3.10833340e+01
  3.67500000e+01  3.88333321e+01  4.56666679e+01  3.30000000e+01
  3.32500000e+01  4.61666679e+01  2.78333340e+01  1.33333337e+00
  1.97500000e+01  3.80833321e+01  3.16666660e+01  3.97500000e+01
  2.02500000e+01  5.95000000e+01  2.24166660e+01  3.40833321e+01
  4.10000000e+01  6.66666687e-01  4.13333321e+01  4.12500000e+01
  1.00000000e+01  2.08333325e+00  7.83333349e+00  3.22500000e+01
  2.03333340e+01  9.41666698e+00  5.65833321e+01  3.75000000e+00
  1.00833330e+01  2.58333325e+00  4.31666679e+01  4.87500000e+01
  3.66666675e+00  2.77500000e+01  4.79166679e+01  2.69166660e+01
  6.37500000e+01  2.16666675e+00  4.58333349e+00  3.51666679e+01
  4.40000000e+01  1.26666670e+01  1.50000000e+01  2.20833340e+01
  1.41666670e+01  3.52500000e+01  5.48333321e+01  2.30833340e+01
  4.50833321e+01  3.72500000e+01  3.24166679e+01  5.28333321e+01
  6.50000000e+00  2.96666660e+01  2.71666660e+01  5.90833321e+01
  4.05000000e+01  1.93333340e+01  2.49166660e+01  1.65833340e+01
  2.91666675e+00  5.19166679e+01  1.66666672e-01  1.40000000e+01
  2.63333340e+01  4.98333321e+01  5.07500000e+01  2.90833340e+01
  2.50000000e-01  2.56666660e+01  2.68333340e+01  4.26666679e+01
  4.41666651e+00  1.04166670e+01  5.37500000e+01  0.00000000e+00
  3.55833321e+01  4.91666651e+00  3.04166660e+01  1.78333340e+01
  3.00833340e+01  5.46666679e+01  9.58333302e+00  2.12500000e+01
  4.94166679e+01  3.57500000e+01  1.91666663e+00  2.94166660e+01
  1.89166660e+01  1.54166670e+01  1.05833330e+01  1.94166660e+01
  3.30833321e+01  1.25000000e+01  1.61666660e+01  4.24166679e+01
  1.68333340e+01  4.60833321e+01  8.50000000e+00  3.91666675e+00
  4.71666679e+01  5.00000000e-01  4.28333321e+01  4.15000000e+01
  2.29166660e+01  3.84166679e+01  2.19166660e+01  1.57500000e+01
  6.83333349e+00  3.96666679e+01  1.55000000e+01  6.16666679e+01
  2.70833340e+01  4.16666679e+01  5.21666679e+01  2.00833340e+01
  3.50000000e+00  2.82500000e+01  1.36666670e+01  6.50833359e+01
  2.87500000e+01  2.52500000e+01  5.13333321e+01  5.25000000e+01
  2.51666660e+01  3.68333321e+01  2.91666660e+01  3.54166679e+01
  4.75833321e+01  2.06666660e+01  5.72500000e+01  3.41666679e+01
  1.10000000e+01  4.92500000e+01  5.10833321e+01  3.20000000e+01
  2.79166660e+01  2.33333340e+01  2.64166660e+01  2.76666660e+01
  4.46666679e+01  5.66666679e+01  3.20833321e+01  5.55833321e+01
  5.79166679e+01  2.48333340e+01  5.30000000e+01  5.55000000e+01
  1.58333337e+00  1.08333337e+00  3.39166679e+01  1.24166670e+01
  7.91666651e+00  9.00000000e+00  4.00000000e+01  5.08333321e+01
  2.00000000e+01  3.35000000e+01  5.36666679e+01  4.33333349e+00
  3.37500000e+01  1.58333330e+01  4.39166679e+01  4.83333321e+01
  4.60000000e+01  8.33333358e-02  5.00000000e+01  4.10833321e+01
  2.04166660e+01  2.99166660e+01  2.50000000e+00  4.50000000e+01
  5.00000000e+00  1.20000000e+01  1.90833340e+01  1.88333340e+01
  7.50000000e+00  2.38333340e+01  1.62500000e+01  8.91666698e+00
  8.41666698e+00  7.00000000e+01  2.33333325e+00  2.14166660e+01
  4.85000000e+01  1.80000000e+01  5.25833321e+01  4.89166679e+01
  2.55000000e+01  2.09166660e+01  6.00000000e+00  2.34166660e+01
  2.83333340e+01  4.01666679e+01  5.99166679e+01  5.60000000e+01
  3.77500000e+01  2.57500000e+01  3.25000000e+00  9.25000000e+00
  3.63333321e+01  1.59166670e+01  1.32500000e+01  1.25833330e+01
  1.85833340e+01  7.50000000e-01  4.38333321e+01  3.86666679e+01
  3.66666679e+01  5.83333313e-01  2.92500000e+01  2.16666660e+01
  6.60000000e+01  5.50833321e+01  1.16666663e+00  5.20000000e+01
  5.44166679e+01  3.65000000e+01  3.23333321e+01  8.83333302e+00
  4.04166679e+01  4.69166679e+01  2.17500000e+01  3.21666679e+01
  5.03333321e+01  1.39166670e+01  4.57500000e+01  1.75000000e+01
  7.75000000e+00  2.73333340e+01  5.58333321e+01  2.46666660e+01
  2.62500000e+01  1.30000000e+01  9.91666698e+00  2.28333340e+01
  1.83333337e+00  2.58333340e+01  2.15833340e+01  2.95833340e+01
  2.26666660e+01  3.76666679e+01  4.45833321e+01  9.75000000e+00
  3.25833321e+01  5.11666679e+01  3.17500000e+01  2.01666660e+01
  2.75833340e+01  5.47500000e+01  1.87500000e+01  4.80833321e+01
  4.97500000e+01  4.90000000e+01  3.45000000e+01  5.91666651e+00
  3.13333340e+01  3.64166679e+01  3.70000000e+01  5.09166679e+01
  4.81666679e+01  6.50000000e+01  4.03333321e+01  3.93333321e+01
  4.76666679e+01  4.08333349e+00  4.48333321e+01  1.35000000e+01
  4.07500000e+01  4.16666651e+00  3.75833321e+01  4.23333321e+01
  5.50000000e+00  4.64166679e+01  1.11666670e+01  1.41666663e+00
  2.50833340e+01  1.44166670e+01  2.11666660e+01  5.49166679e+01
  4.20833321e+01  2.60000000e+01  4.30833321e+01  1.83333340e+01
  3.28333321e+01  1.69166660e+01  1.82500000e+01  3.90000000e+01
  3.50000000e+01  1.63333340e+01  1.74166660e+01  1.23333330e+01
  1.37500000e+01  5.41666651e+00  2.23333340e+01  5.70833321e+01
  8.33333302e+00  3.55000000e+01  4.59166679e+01  2.95000000e+01
  3.53333321e+01  3.74166679e+01  5.39166679e+01  6.30000000e+01
  6.91666651e+00  1.19166670e+01  8.66666698e+00  4.34166679e+01
  2.41666675e+00  6.58333349e+00  4.83333349e+00  5.69166679e+01
  8.00000000e+00  1.47500000e+01  2.22500000e+01  3.61666679e+01
  4.00833321e+01  1.52500000e+01  3.19166660e+01  3.06666660e+01
  5.24166679e+01  5.77500000e+01  3.08333340e+01  5.42500000e+01
  4.30000000e+01  5.60833321e+01  1.72500000e+01  3.08333325e+00
  2.47500000e+01  4.88333321e+01  4.18333321e+01  2.90000000e+01
  3.91666679e+01  3.25000000e+01  1.13333330e+01  3.38333321e+01
  2.42500000e+01  4.17500000e+01  2.05000000e+01  4.49166679e+01
  4.73333321e+01  3.83333325e+00  3.83333321e+01  1.45000000e+01
  6.75000000e+00  4.55833321e+01  4.95833321e+01  2.75000000e+01
  2.70000000e+01  1.05000000e+01  8.33333313e-01  2.05833340e+01
  3.00000000e+00  9.66666698e+00  1.76666660e+01  4.84166679e+01
  2.53333340e+01  1.67500000e+01  6.33333349e+00  3.50833321e+01
  2.81666660e+01  1.18333330e+01  2.25000000e+01  5.02500000e+01
  4.35833321e+01  5.06666679e+01  3.33333343e-01  1.60833340e+01
  4.70000000e+01  6.25000000e+00  1.21666670e+01  4.82500000e+01
  1.16666670e+01  9.83333302e+00  3.85000000e+01  5.63333321e+01
  1.50000000e+00  4.75000000e+01  3.95833321e+01  6.58333359e+01
 -3.33333343e-01  2.41666660e+01  1.50833330e+01  8.58333302e+00
  6.67500000e+01  4.50000000e+00  5.58333349e+00  1.84166660e+01
  2.08333340e+01  4.06666679e+01  5.53333321e+01  7.41666651e+00
  4.75000000e+00  2.86666660e+01  2.15000000e+01  1.45833330e+01
  5.17500000e+01  2.59166660e+01  1.55833330e+01  4.36666679e+01
  1.25000000e+00  1.06666670e+01  4.19166679e+01  1.73333340e+01
  1.10833330e+01  5.91666679e+01  1.70833340e+01  3.40000000e+01
  1.66666660e+01  2.43333340e+01  4.20000000e+01  1.70000000e+01
  7.16666651e+00  5.57500000e+01  2.40000000e+01  6.08333349e+00
  1.92500000e+01  4.08333321e+01  1.01666670e+01  2.93333340e+01
  2.66666660e+01  5.75000000e+00  6.26666679e+01  4.22500000e+01
  1.95000000e+01  1.90000000e+01  3.60000000e+01  4.68333321e+01
  1.29166670e+01  1.75000000e+00  1.27500000e+01  9.16666687e-01
  6.21666679e+01  4.54166679e+01  9.08333302e+00  8.08333302e+00
  5.40833321e+01  4.78333321e+01  7.08333349e+00  4.11666679e+01
  3.15000000e+01  7.25000000e+00  4.14166679e+01  1.99166660e+01
  6.08333321e+01  2.25000000e+00  1.30833330e+01  1.56666670e+01
  1.15833330e+01  8.25000000e+00  7.00000000e+00  4.00000000e+00
  3.33333325e+00  4.65833321e+01  6.16666651e+00  1.02500000e+01
  6.00000000e+01  4.33333321e+01  4.65000000e+01  2.60833340e+01
  1.31666670e+01  1.17500000e+01  2.55833340e+01  4.42500000e+01
  1.51666670e+01  3.09166660e+01  2.65833340e+01  1.48333330e+01
  5.38333321e+01  9.33333302e+00  2.66666675e+00  2.25833340e+01
  6.28333321e+01  4.72500000e+01  2.50000000e+01  1.42500000e+01
  1.38333330e+01  4.16666657e-01  2.13333340e+01  2.37500000e+01
  3.98333321e+01  5.22500000e+01  1.53333330e+01  3.85833321e+01
  3.00000000e+01  7.58333349e+00  4.25000000e+00  3.78333321e+01
  3.87500000e+01  5.50000000e+01  4.85833321e+01  2.21666660e+01
  6.47500000e+01  8.75000000e+00  3.16666675e+00  1.20833330e+01
  6.66666651e+00  3.75000000e+01  1.43333330e+01  3.56666679e+01
  1.40833330e+01  3.82500000e+01  4.58333321e+01  1.35833330e+01
  5.33333349e+00  4.66666651e+00  1.22500000e+01  5.20833321e+01
  1.08333330e+01  3.71666679e+01  2.83333325e+00  4.41666679e+01
  6.90833359e+01  3.92500000e+01  3.80000000e+01  4.21666679e+01
  3.46666679e+01  5.76666679e+01  1.07500000e+01  5.25000000e+00
  6.07500000e+01  4.51666679e+01  5.10000000e+01  2.00000000e+00
  1.28333330e+01  1.34166670e+01  6.40833359e+01  5.68333321e+01
  2.07500000e+01  3.49166679e+01  4.09166679e+01  5.45000000e+01
  5.35833321e+01  1.60000000e+01  3.60833321e+01  6.80000000e+01
  2.61666660e+01  5.54166679e+01  4.77500000e+01  1.00000000e+00
  3.33333321e+01  1.12500000e+01  6.00833321e+01  1.86666660e+01
  1.79166660e+01  3.03333340e+01  3.73333321e+01  5.43333321e+01
  5.15000000e+01  3.05833340e+01  4.55000000e+01  1.49166670e+01
  4.15833321e+01  3.10000000e+01  3.05000000e+01  6.06666679e+01
  3.48333321e+01  3.94166679e+01  4.47500000e+01  2.72500000e+01
  3.15833340e+01  3.44166679e+01  2.84166660e+01  4.67500000e+01
  2.35000000e+01  3.14166660e+01  4.37500000e+01  3.69166679e+01
  2.45833340e+01  5.01666679e+01  6.12500000e+01  1.14166670e+01
  2.20000000e+01  7.51666641e+01  6.45833359e+01  7.33333349e+00
  6.69166641e+01  3.29166679e+01  5.12500000e+01  1.71666660e+01
  5.45833321e+01  2.27500000e+01  5.62500000e+01  5.90000000e+01
  5.08333349e+00  4.63333321e+01  2.32500000e+01  6.11666679e+01
  4.74166679e+01  2.10833340e+01  9.50000000e+00  5.30833321e+01
  1.81666660e+01  2.85833340e+01  3.36666679e+01  4.25000000e+01
  4.66666679e+01  3.70833321e+01  6.73333359e+01  4.05833321e+01
  5.65000000e+01  1.96666660e+01  2.18333340e+01  2.85000000e+01
  4.44166679e+01  3.12500000e+01  4.45000000e+01  6.23333321e+01
  4.40833321e+01  5.00833321e+01  6.10833321e+01  1.98333340e+01
  4.99166679e+01  5.34166679e+01  2.97500000e+01  5.35000000e+01
  5.88333321e+01  6.19166679e+01  4.29166679e+01  5.95833321e+01
  5.40000000e+01  5.05000000e+01  1.65000000e+01  2.54166660e+01
  5.86666679e+01  3.79166679e+01  3.45833321e+01  7.66666651e+00
  2.31666660e+01  6.10000000e+01  6.70000000e+01  5.80000000e+01
  5.70000000e+01  4.80000000e+01  7.40000000e+01  6.90000000e+01
  7.10000000e+01  6.20000000e+01  6.40000000e+01  7.20000000e+01
  5.74166679e+01  3.35833321e+01  6.75833359e+01  5.73333321e+01
  6.25000000e+01  4.35000000e+01  4.27500000e+01  6.41666641e+01
  5.18333321e+01  6.97500000e+01  5.71666679e+01  6.02500000e+01
  5.83333321e+01  7.46666641e+01  5.31666679e+01  3.01666660e+01
  5.97500000e+01  6.05000000e+01  5.23333321e+01  5.05833321e+01
  3.26666679e+01  5.89166679e+01  5.16666679e+01  5.29166679e+01
  7.14166641e+01  3.27500000e+01  5.64166679e+01  3.07500000e+01
  5.85000000e+01  4.32500000e+01  2.39166660e+01  5.32500000e+01
  6.04166679e+01  4.62500000e+01  6.54166641e+01  5.56666679e+01
  5.04166679e+01  6.15000000e+01  5.82500000e+01  7.26666641e+01
  5.85833321e+01  5.61666679e+01  6.55000000e+01  5.67500000e+01
  6.53333359e+01  3.62500000e+01  5.14166679e+01  5.87500000e+01
  1.85000000e+01  7.15833359e+01  6.09166679e+01  6.13333321e+01
  3.31666679e+01  4.52500000e+01  4.96666679e+01  5.94166679e+01
  1.01750000e+02]

Column: sex_frequency
Data type: object
Unique values: ['once_or_twice_a_week' 'once_a_month_or_less' '2_to_3_times_a_month' nan
 '3_to_6_times_a_week' 'once_or_more_a_day']

Column: wave
Data type: object
Unique values: ['2017' '2020' '2022']

Column: flirts_with_partner
Data type: category
Unique values: [NaN, 'never', 'a_few_times_a_week', 'less_than_once_a_month', '1_to_3_times_a_month', 'every_day', 'once_a_week']
Categories (6, object): ['every_day' &lt; 'a_few_times_a_week' &lt; 'once_a_week' &lt; '1_to_3_times_a_month' &lt; 'less_than_once_a_month' &lt; 'never']

Column: fights_with_partner
Data type: category
Unique values: [NaN, '0_times', '3_times', '2_times', '1_time', '7_or_more_times', '4_times', '5_times', '6_times']
Categories (8, object): ['0_times' &lt; '1_time' &lt; '2_times' &lt; '3_times' &lt; '4_times' &lt; '5_times' &lt; '6_times' &lt; '7_or_more_times']

Column: rel_change_during_pandemic
Data type: object
Unique values: [nan 'better_than_before' 'no_change' 'worse_than_before']

Column: inc_change_during_pandemic
Data type: object
Unique values: [nan 'no_change' 'worse' 'much_worse' 'better' 'much_better']

Column: subject_had_covid
Data type: object
Unique values: [nan 'no' 'yes']

Column: partner_had_covid
Data type: object
Unique values: [nan 'yes' 'no']

Column: subject_vaccinated
Data type: object
Unique values: [nan 'not_vaccinated' 'fully_vaccinated_and_booster'
 'fully_vaccinated_no_booster' 'partially_vaccinated']

Column: partner_vaccinated
Data type: object
Unique values: [nan 'not_vaccinated' 'fully_vaccinated_and_booster'
 'partially_vaccinated' 'fully_vaccinated_no_booster']

Column: agree_covid_approach
Data type: object
Unique values: [nan 'completely_agree' 'mostly_agree' 'completely_disagree'
 'mostly_disagree']

Column: children
Data type: float64
Unique values: [ 1.  2.  5.  4.  6.  3.  8. 10.  7.  9. 12.]
</code></pre>
</div>
</div>
</section>
<section id="saving-csv" class="level2">
<h2 class="anchored" data-anchor-id="saving-csv">Saving CSV</h2>
<div id="3de5d0e4-49bd-4385-aff6-64475a118186" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>data.to_csv(<span class="st">"../data/clean/hcmst.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testing-a-2022-data-set" class="level2">
<h2 class="anchored" data-anchor-id="testing-a-2022-data-set">Testing a 2022 data set:</h2>
<p>During the client meeting on May 21st, 2025. It was decided to only keep 2022 data, while removing mostly sparse columns, id and wave values.</p>
<div id="fe1f1bc8-480d-4d2f-87ca-3224fb462007" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>clean <span class="op">=</span> pd.read_csv(<span class="st">"../data/clean/hcmst.csv"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>clean.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">wave</th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">partner_sex</th>
<th data-quarto-table-cell-role="th">partner_age</th>
<th data-quarto-table-cell-role="th">partner_ethnicity</th>
<th data-quarto-table-cell-role="th">partner_education</th>
<th data-quarto-table-cell-role="th">same_sex_couple</th>
<th data-quarto-table-cell-role="th">married</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">relationship_start_year</th>
<th data-quarto-table-cell-role="th">marriage_year</th>
<th data-quarto-table-cell-role="th">break_up_year</th>
<th data-quarto-table-cell-role="th">relationship_duration</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">rel_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
<th data-quarto-table-cell-role="th">relationship_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>53001</td>
<td>2017</td>
<td>48.0</td>
<td>high_school_grad</td>
<td>female</td>
<td>2_plus_eth</td>
<td>60k_75k</td>
<td>working_paid_employee</td>
<td>male</td>
<td>46.0</td>
<td>white</td>
<td>associate_degree</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>NaN</td>
<td>NaN</td>
<td>2013.0</td>
<td>2014.0</td>
<td>NaN</td>
<td>3.583333</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>71609</td>
<td>2017</td>
<td>68.0</td>
<td>some_college</td>
<td>female</td>
<td>white</td>
<td>50k_60k</td>
<td>working_paid_employee</td>
<td>male</td>
<td>71.0</td>
<td>white</td>
<td>some_college</td>
<td>no</td>
<td>married</td>
<td>once_a_month_or_less</td>
<td>NaN</td>
<td>NaN</td>
<td>1964.0</td>
<td>1969.0</td>
<td>NaN</td>
<td>52.750000</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>106983</td>
<td>2017</td>
<td>39.0</td>
<td>associate_degree</td>
<td>male</td>
<td>white</td>
<td>85k_100k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>49.0</td>
<td>white</td>
<td>some_college</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>NaN</td>
<td>NaN</td>
<td>1999.0</td>
<td>2002.0</td>
<td>NaN</td>
<td>17.583334</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>121759</td>
<td>2017</td>
<td>54.0</td>
<td>high_school_grad</td>
<td>male</td>
<td>white</td>
<td>100k_125k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>59.0</td>
<td>asian</td>
<td>masters_degree</td>
<td>no</td>
<td>married</td>
<td>2_to_3_times_a_month</td>
<td>NaN</td>
<td>NaN</td>
<td>1990.0</td>
<td>1991.0</td>
<td>NaN</td>
<td>27.416666</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>excellent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>158083</td>
<td>2017</td>
<td>48.0</td>
<td>some_college</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>female</td>
<td>34.0</td>
<td>white</td>
<td>associate_degree</td>
<td>no</td>
<td>not_married</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011.0</td>
<td>2013.0</td>
<td>2014.0</td>
<td>NaN</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f62e0efe-67c7-4006-ac2b-866bff1d5d4c" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>data_2022 <span class="op">=</span> clean[clean[<span class="st">'wave'</span>] <span class="op">==</span> <span class="dv">2022</span>].dropna(subset<span class="op">=</span>[<span class="st">'rel_change_during_pandemic'</span>, <span class="st">'relationship_quality'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8edc35bc-af9c-4d68-aa59-a75ae3cd9793" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>data_2022.columns.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>['id',
 'wave',
 'subject_age',
 'subject_education',
 'subject_sex',
 'subject_ethnicity',
 'subject_income_category',
 'subject_employment_status',
 'partner_sex',
 'partner_age',
 'partner_ethnicity',
 'partner_education',
 'same_sex_couple',
 'married',
 'sex_frequency',
 'flirts_with_partner',
 'fights_with_partner',
 'relationship_start_year',
 'marriage_year',
 'break_up_year',
 'relationship_duration',
 'children',
 'rel_change_during_pandemic',
 'inc_change_during_pandemic',
 'subject_had_covid',
 'partner_had_covid',
 'subject_vaccinated',
 'partner_vaccinated',
 'agree_covid_approach',
 'relationship_quality']</code></pre>
</div>
</div>
<div id="82b71f2f-3c5c-44a6-8104-bf94ae6f7076" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>data_2022 <span class="op">=</span> data_2022[[</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_age'</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_education'</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_sex'</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_ethnicity'</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_income_category'</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_employment_status'</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'same_sex_couple'</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'married'</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'sex_frequency'</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'flirts_with_partner'</span>,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a> <span class="st">'fights_with_partner'</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a> <span class="st">'relationship_duration'</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a> <span class="st">'children'</span>,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a> <span class="st">'rel_change_during_pandemic'</span>,</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a> <span class="st">'inc_change_during_pandemic'</span>,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_had_covid'</span>,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a> <span class="st">'partner_had_covid'</span>,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a> <span class="st">'subject_vaccinated'</span>,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a> <span class="st">'partner_vaccinated'</span>,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a> <span class="st">'agree_covid_approach'</span>,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a> <span class="st">'relationship_quality'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="99da20d0-a6da-4aeb-8266-9ef345b3a62b" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>data_2022.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">subject_age</th>
<th data-quarto-table-cell-role="th">subject_education</th>
<th data-quarto-table-cell-role="th">subject_sex</th>
<th data-quarto-table-cell-role="th">subject_ethnicity</th>
<th data-quarto-table-cell-role="th">subject_income_category</th>
<th data-quarto-table-cell-role="th">subject_employment_status</th>
<th data-quarto-table-cell-role="th">same_sex_couple</th>
<th data-quarto-table-cell-role="th">married</th>
<th data-quarto-table-cell-role="th">sex_frequency</th>
<th data-quarto-table-cell-role="th">flirts_with_partner</th>
<th data-quarto-table-cell-role="th">fights_with_partner</th>
<th data-quarto-table-cell-role="th">relationship_duration</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">rel_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">inc_change_during_pandemic</th>
<th data-quarto-table-cell-role="th">subject_had_covid</th>
<th data-quarto-table-cell-role="th">partner_had_covid</th>
<th data-quarto-table-cell-role="th">subject_vaccinated</th>
<th data-quarto-table-cell-role="th">partner_vaccinated</th>
<th data-quarto-table-cell-role="th">agree_covid_approach</th>
<th data-quarto-table-cell-role="th">relationship_quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5617</td>
<td>53.0</td>
<td>high_school_grad</td>
<td>female</td>
<td>white</td>
<td>35k_40k</td>
<td>working_paid_employee</td>
<td>no</td>
<td>not_married</td>
<td>once_or_twice_a_week</td>
<td>a_few_times_a_week</td>
<td>0_times</td>
<td>1.500000</td>
<td>2.0</td>
<td>better_than_before</td>
<td>no_change</td>
<td>no</td>
<td>yes</td>
<td>not_vaccinated</td>
<td>not_vaccinated</td>
<td>completely_agree</td>
<td>excellent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5618</td>
<td>72.0</td>
<td>some_college</td>
<td>female</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>no</td>
<td>married</td>
<td>once_a_month_or_less</td>
<td>never</td>
<td>7_or_more_times</td>
<td>57.416668</td>
<td>1.0</td>
<td>no_change</td>
<td>worse</td>
<td>no</td>
<td>no</td>
<td>fully_vaccinated_and_booster</td>
<td>fully_vaccinated_and_booster</td>
<td>mostly_agree</td>
<td>good</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5619</td>
<td>43.0</td>
<td>associate_degree</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>a_few_times_a_week</td>
<td>2_times</td>
<td>22.333334</td>
<td>5.0</td>
<td>no_change</td>
<td>worse</td>
<td>no</td>
<td>no</td>
<td>fully_vaccinated_and_booster</td>
<td>fully_vaccinated_and_booster</td>
<td>completely_agree</td>
<td>excellent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5621</td>
<td>64.0</td>
<td>some_college</td>
<td>male</td>
<td>white</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>1_to_3_times_a_month</td>
<td>0_times</td>
<td>28.250000</td>
<td>2.0</td>
<td>no_change</td>
<td>no_change</td>
<td>no</td>
<td>no</td>
<td>fully_vaccinated_and_booster</td>
<td>fully_vaccinated_and_booster</td>
<td>completely_agree</td>
<td>good</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5623</td>
<td>60.0</td>
<td>high_school_grad</td>
<td>female</td>
<td>black</td>
<td>75k_85k</td>
<td>working_paid_employee</td>
<td>no</td>
<td>married</td>
<td>once_or_twice_a_week</td>
<td>a_few_times_a_week</td>
<td>0_times</td>
<td>38.916668</td>
<td>3.0</td>
<td>better_than_before</td>
<td>no_change</td>
<td>no</td>
<td>no</td>
<td>not_vaccinated</td>
<td>partially_vaccinated</td>
<td>completely_agree</td>
<td>excellent</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="dd5e648d-99fb-4992-9c93-5f2a953bbaea" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>data_2022.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>(1328, 21)</code></pre>
</div>
</div>
<div id="610422d4-a058-491c-8490-bd6a2f758d86" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>data_2022.to_csv(<span class="st">"../data/clean/hcmst.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>