{
  "hash": "bfdaf83c41382c583fe414f3be913585",
  "result": {
    "engine": "knitr",
    "markdown": "::: {.cell}\n\n:::\n\n\n\n### Key Features of the Data Set\n\nEach row in the data set represents an individual subject and includes the following selected variables:\n\n-   **Subject demographics**: age, sex, ethnicity, education level, income level, and employment status\n\n-   **Relationship context**: whether the subject is part of a same-sex relationship, whether they are married, the duration of the relationship and how many children are in the household.\n\n-   **Couple behavior indicators**: sex, flirting and fighting frequency.\n\n-   **Pandemic Variables**: interpreted impact of the pandemic in the relationship, income change during the pandemic, if the subject and their partner were sick with COVID-19 and if they were vaccinated.\n\n-   **Quality of the relationship**: variable used to measure the subject's perceived quality of their relationship.\n\n### Purpose and Use Cases\n\nThis data set supports investigations into:\n\n-   Demographic and behavioral predictors of relationship quality.\n\n-   How the pandemic experience affected relationships.\n\n-   Differences in relationship dynamics between different levels of income, sex and sexual orientation.\n\n## Case Study\n\n### Objective\n\n**What behavioral factors are strongly associated with relationship quality in the context of the COVID-19 pandemic? Are these factors different for same sex couples?**\n\nThis case study examines the association between `relationship_quality` and a variety of behavioral and pandemic-related variables.\n\nBy examining survey data, we aim to:\n\n-   Identify the behavioral factors that most strongly affect the perceived relationship quality. We will focus specifically on finding how `sex_frequency`, `flirts_with_partner` and `fights_with_partner` affect the perception of relationship quality and we are going to evaluate if these factors have a different impact on same sex couples (`same_sex_couple`).\n-   We will also evaluate whether COVID-19 related factors such vaccination status (`subject_vaccinated`, `partner_vaccinated`), COVID-19 illness (`subject_had_covid`, `partner_had_covid`), income changes during the pandemic (`inc_change_during_pandemic`), and agreement on pandemic-related approaches (`agree_covid_approach`) affected couples' perceived relationship quality.\n\n### Analysis\n\nFirst, we need to load the libraries that will be used through the exercise, including the `diversedata` package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(diversedata)\nlibrary(tidyverse) \nlibrary(scales)\nlibrary(cowplot)\nlibrary(MASS)\nlibrary(broom)\nlibrary(brant)\nlibrary(knitr)\n```\n:::\n\n\n\n#### 1. Data Cleaning & Processing\n\nFirst, we can load our data set (`hcmst` from `diversedata` package), select our specific variables of intereset and remove NAs from our data set.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reading Data\nhcmst <- hcmst\n\n# Review total rows\nnrow(hcmst)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1328\n```\n\n\n:::\n\n```{.r .cell-code}\n# Select features of interest and removing NA\nhcmst <- hcmst |> \n  dplyr::select(\n    same_sex_couple, \n    sex_frequency, \n    flirts_with_partner, \n    fights_with_partner,\n    inc_change_during_pandemic, \n    subject_had_covid, \n    partner_had_covid, \n    subject_vaccinated, \n    partner_vaccinated, \n    agree_covid_approach, \n    relationship_quality) |> \n  drop_na()\n\n# Remaining row count.\nnrow(hcmst)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1220\n```\n\n\n:::\n:::\n\n\n\n#### 2. Variable Encoding\n\nWe can note that our categorical response follows a specific order. For this reason, we require a model that suits ordinal responses. Hence, we will be using an Ordinal Logistic regression model framework.\n\nIn order to do so, we need to make sure that our response variable is encoded as an ordered factor. We will also take this opportunity to encode our explanatory variables as factors (and ordered factors) as needed.\n\nFirst, we can encode our nominal categorical explanatory variables:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(same_sex_couple = as_factor(same_sex_couple)|> \n           fct_recode(\"No\" = \"no\", \"Yes\" = \"yes\"))\n\nlevels(hcmst$same_sex_couple)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"No\"  \"Yes\"\n```\n\n\n:::\n:::\n\n\n\nThen, we can encode all our ordinal, categorical, explanatory, behavioral variables:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(sex_frequency = as.ordered(sex_frequency)) |> \n  mutate(sex_frequency = fct_relevel(sex_frequency, \n      c(\"once_a_month_or_less\", \"2_to_3_times_a_month\", \n        \"once_or_twice_a_week\", \"3_to_6_times_a_week\", \n        \"once_or_more_a_day\")))\n\nlevels(hcmst$sex_frequency)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"once_a_month_or_less\" \"2_to_3_times_a_month\" \"once_or_twice_a_week\"\n[4] \"3_to_6_times_a_week\"  \"once_or_more_a_day\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(flirts_with_partner = as.ordered(flirts_with_partner)) |> \n  mutate(flirts_with_partner = fct_relevel(flirts_with_partner, \n      c(\"never\", \"less_than_once_a_month\", \n        \"1_to_3_times_a_month\", \"once_a_week\", \n        \"a_few_times_a_week\", \"every_day\")))\n\nlevels(hcmst$flirts_with_partner)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"never\"                  \"less_than_once_a_month\" \"1_to_3_times_a_month\"  \n[4] \"once_a_week\"            \"a_few_times_a_week\"     \"every_day\"             \n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(fights_with_partner = as.ordered(fights_with_partner)) |> \n  mutate(fights_with_partner = fct_relevel(fights_with_partner, \n      c(\"0_times\", \"1_time\", \"2_times\", \"3_times\", \"4_times\", \n        \"5_times\", \"6_times\", \"7_or_more_times\")))\n\nlevels(hcmst$sex_frequency)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"once_a_month_or_less\" \"2_to_3_times_a_month\" \"once_or_twice_a_week\"\n[4] \"3_to_6_times_a_week\"  \"once_or_more_a_day\"  \n```\n\n\n:::\n:::\n\n\n\nThen, we can encode all our ordinal, categorical, explanatory, COVID-19-related variables:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(inc_change_during_pandemic = as.ordered(inc_change_during_pandemic)) |> \n  mutate(inc_change_during_pandemic = fct_relevel(inc_change_during_pandemic, \n      c(\"much_worse\", \"worse\", \"no_change\", \"better\", \"much_better\")))\n\nlevels(hcmst$inc_change_during_pandemic)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"much_worse\"  \"worse\"       \"no_change\"   \"better\"      \"much_better\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(subject_had_covid = as_factor(subject_had_covid))\n\nlevels(hcmst$subject_had_covid)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"no\"  \"yes\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(partner_had_covid = as_factor(partner_had_covid))\n\nlevels(hcmst$partner_had_covid)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"yes\" \"no\" \n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(subject_vaccinated = as.ordered(subject_vaccinated)) |> \n  mutate(subject_vaccinated = fct_relevel(subject_vaccinated, \n      c(\"not_vaccinated\", \"partially_vaccinated\", \n        \"fully_vaccinated_no_booster\", \"fully_vaccinated_and_booster\")))\n\nlevels(hcmst$subject_vaccinated)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"not_vaccinated\"               \"partially_vaccinated\"        \n[3] \"fully_vaccinated_no_booster\"  \"fully_vaccinated_and_booster\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(partner_vaccinated = as.ordered(partner_vaccinated)) |> \n  mutate(partner_vaccinated = fct_relevel(partner_vaccinated, \n      c(\"not_vaccinated\", \"partially_vaccinated\", \n        \"fully_vaccinated_no_booster\", \"fully_vaccinated_and_booster\")))\n\nlevels(hcmst$partner_vaccinated)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"not_vaccinated\"               \"partially_vaccinated\"        \n[3] \"fully_vaccinated_no_booster\"  \"fully_vaccinated_and_booster\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(agree_covid_approach = as.ordered(agree_covid_approach)) |> \n  mutate(agree_covid_approach = fct_relevel(agree_covid_approach, \n      c(\"completely_disagree\", \"mostly_disagree\", \n        \"mostly_agree\", \"completely_agree\")))\n\nlevels(hcmst$agree_covid_approach)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"completely_disagree\" \"mostly_disagree\"     \"mostly_agree\"       \n[4] \"completely_agree\"   \n```\n\n\n:::\n:::\n\n\n\nFinally, we can encode our target variable:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhcmst <- hcmst |> \n  mutate(relationship_quality = as.ordered(relationship_quality)) |> \n  mutate(relationship_quality = fct_relevel(relationship_quality, \n      c(\"very_poor\", \"poor\", \"fair\", \"good\", \"excellent\")))\n\nlevels(hcmst$sex_frequency)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"once_a_month_or_less\" \"2_to_3_times_a_month\" \"once_or_twice_a_week\"\n[4] \"3_to_6_times_a_week\"  \"once_or_more_a_day\"  \n```\n\n\n:::\n:::\n\n\n\n#### 3. Exploratory Data Analysis\n\nWe will visualize histograms charts for our different categorical variables. But first, we will see how different groups were sampled in the survey and how different these samples are for same sex couples.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We'll use a color blind friendly pallete:\ncbPalette <- c(\"#0072B2\", \"#56B4E9\", \"#999999\", \"#E69F00\", \"#009E73\", \"#F0E442\", \"#D55E00\", \"#CC79A7\")\n\nggplot(hcmst, aes(x = same_sex_couple, fill = same_sex_couple)) +\n  geom_bar(position = \"dodge\", color = \"white\") +\n  labs(\n    title = \"Couple Type Distribution\",\n    x = \"Same Sex Couple\",\n    y = \"Count\",\n    fill = \"Same Sex Couple\"\n  ) +\n  theme_minimal() +\n  scale_fill_manual(values = cbPalette) +\n  scale_y_continuous(breaks = seq(0, 1200, by = 100))\n```\n\n::: {.cell-output-display}\n![](hcmst_files/figure-html/simple_bar-1.png){width=768}\n:::\n:::\n\n\n\nIt can be noted that the sample of `same_sex_couples` is smaller that that of different-sex couples. In the original study, same sex couples were oversampled. For more information on how the survey data was collected, refer to the [original data set](https://data.stanford.edu/hcmst2017).\n\nTo explore our other variables, we will create a function that will be used for visualization. Since we know that the samples for different types of couples are different, we will use relative frequency in our visualizations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhistogram_plot <- function(data, y_var, facet, plot_title = \"Relative Frequency by Category\", label_map) {\n  data_long <- data |> \n    dplyr::select(all_of(c(y_var, facet))) |> \n    pivot_longer(cols = all_of(y_var), names_to = \"var\", values_to = \"value\") |> \n    mutate(value = recode(value, !!!label_map)) |> \n    count(var, value, facet_value = .data[[facet]]) |> \n    group_by(facet_value) |> \n    mutate(prop = n / sum(n)) |> \n    ungroup()\n\n  ggplot(data_long, aes(x = prop, y = value, fill = facet_value)) +\n    geom_bar(stat = \"identity\", position = \"dodge\", color = \"white\") +\n    labs(\n      title = plot_title,\n      x = \"Relative Frequency\",\n      y = NULL,\n      fill = \"Same Sex Couple\"\n    ) +\n    theme_minimal() +\n    scale_fill_manual(values = cbPalette)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsex_freq_labels <- c(\n  \"once_a_month_or_less\" = \"Once a Month or Less\",\n  \"2_to_3_times_a_month\" = \"Two or Three Times a Month\",\n  \"once_or_twice_a_week\" = \"Once or Twice a Week\",\n  \"3_to_6_times_a_week\" = \"Three to Six Times a Week\",\n  \"once_or_more_a_day\" = \"Once or More a Day\"\n)\n\nhist_sex_freq <- histogram_plot(hcmst, \"sex_frequency\", \"same_sex_couple\", \n  plot_title = \"Sex Frequency\", label_map = sex_freq_labels)\n\nflirt_freq_labels <- c(\n  \"never\" = \"Never\",\n  \"less_than_once_a_month\" = \"Less Than Once a Month\",\n  \"1_to_3_times_a_month\" = \"One to Three Times a Month\",\n  \"once_a_week\" = \"Once a Week\",\n  \"a_few_times_a_week\" = \"A Few Times a Week\",\n  \"every_day\" = \"Every Day\" \n)\n\nhist_flirt_freq <- histogram_plot(hcmst, \"flirts_with_partner\", \n  \"same_sex_couple\", plot_title = \"Flirting Frequency\",\n  label_map = flirt_freq_labels)\n\nfight_freq_labels <- c(\n  \"0_times\" = \"Zero Times\",\n  \"1_time\" = \"One Time\",\n  \"2_times\" = \"Two Times\",\n  \"3_times\" = \"Three Times\",\n  \"4_times\" = \"Four Times\",\n  \"5_times\" = \"Five Times\",\n  \"6_times\" = \"Six Times\",\n  \"7_or_more_times\" = \"Seven or More Times\"\n)\n\nhist_fight_freq <- histogram_plot(hcmst, \"fights_with_partner\", \n  \"same_sex_couple\", plot_title = \"Fighting Frequency\",\n  label_map = fight_freq_labels)\n\ninc_labels <- c(\n  \"much_worse\" = \"Much Worse\",\n  \"worse\" = \"Worse\",\n  \"no_change\" = \"No Change\",\n  \"better\" = \"Better\",\n  \"much_better\" = \"Much Better\"\n)\n\nhist_inc_change_freq <- histogram_plot(hcmst, \"inc_change_during_pandemic\",\n  \"same_sex_couple\", plot_title = \"Income Change During Pandemic Frequency\",\n  label_map = inc_labels)\n\nyes_no_label <- c(\"no\" = \"No\", \"yes\" = \"Yes\")\n\nhist_sub_covid_freq <- histogram_plot(hcmst, \"subject_had_covid\", \n  \"same_sex_couple\", plot_title = \"Subject had COVID-19 Frequency\",\n  label_map = yes_no_label)\n\nhist_par_covid_freq <- histogram_plot(hcmst, \"partner_had_covid\", \n  \"same_sex_couple\", plot_title = \"Partner had COVID-19 Frequency\",\n  label_map = yes_no_label)\n\nvax_label <- c(\n  \"not_vaccinated\" = \"Not Vaccinated\",\n  \"partially_vaccinated\" = \"Partially Vaccinated\",\n  \"fully_vaccinated_no_booster\" = \"Fully Vaccinated No Booster\",\n  \"fully_vaccinated_and_booster\" = \"Fully Vaccinated and Booster\"\n)\n\nhist_sub_vax_freq <- histogram_plot(hcmst, \"subject_vaccinated\", \n  \"same_sex_couple\", plot_title = \"Subject Vaccination Status Frequency\",\n  label_map = vax_label)\n\nhist_par_vax_freq <- histogram_plot(hcmst, \"partner_vaccinated\", \n  \"same_sex_couple\", plot_title = \"Partner Vaccination Status Frequency\",\n  label_map = vax_label)\n\napproach_label <- c(\n  \"completely_disagree\" = \"Completely Disagree\",\n  \"mostly_disagree\" = \"Mostly Disagree\",\n  \"mostly_agree\" = \"Mostly Agree\",\n  \"completely_agree\" = \"Completely Agree\"\n)\n\nhist_cov_approach_freq <- histogram_plot(hcmst, \"agree_covid_approach\", \n  \"same_sex_couple\", plot_title = \"Agreement on Pandemic Approach Frequency\",\n  label_map = approach_label)\n\nquality_label <- c(\n  \"very_poor\" =\"Very Poor\",\n  \"poor\" = \"Poor\",\n  \"fair\" = \"Fair\",\n  \"good\" = \"Good\",\n  \"excellent\" = \"Excellent\"\n)\n\nhist_quality_freq <- histogram_plot(hcmst, \"relationship_quality\", \n  \"same_sex_couple\", plot_title = \"Relationship Quality Frequency\",\n  label_map = quality_label)\n\nplot_grid(\n  hist_sex_freq,\n  hist_flirt_freq, \n  hist_fight_freq, \n  hist_inc_change_freq,\n  hist_sub_covid_freq,\n  hist_par_covid_freq,\n  hist_sub_vax_freq,\n  hist_par_vax_freq,\n  hist_cov_approach_freq,\n  hist_quality_freq,\n  ncol = 1, align = \"v\", axis = \"lr\")\n```\n\n::: {.cell-output-display}\n![](hcmst_files/figure-html/histograms-1.png){width=768}\n:::\n:::\n\n\n\nSame-sex and different-sex couples show similar patters in how frequently they engage in sexual activity. However, the overall sample is skewed towards reporting low sex frequency. We can also visualize how often couples flirt with or fight with their partners. The distribution of responses shows a tendency toward lower frequencies of both flirting and fighting.\n\nIn the context of the COVID-19 pandemic, it can be noted that most subjects had no change in income during the pandemic, did not have COVID, were fully vaccinated including the booster shot, and completely agreed with their partners in terms of their approach to the pandemic.\n\nAs for our target variable, most participants perceived the quality of their relationship to be `good` or `excellent`.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n#### 4. Model Fitting and Assumptions\n\nWe will be assuming and fitting a proportional odds model, which assumes that the log-odds of being in a higher category of the response variable follows a linear relationship with the explanatory variables.\n\nFor our modeling purposes, we will use the `MASS` package, `polr()` function to obtain model estimates.\n\nGiven that we are using ordinal categorical variables as explanatory variables, we will also set our model to use successive differences contrasts to facilitate the interpretation of the estimates.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(contrasts = c(\"contr.treatment\", \"contr.sdif\"))\n```\n:::\n\n\n\nNow, we can fit our model. Noting that `polr()` does not calculate p-values, we can compute them and bind them to our model estimates.\n\nFor the purposes of this exercise, we will only use a subset of the variables in our modeling. We will be interested in how behavioral variables, as well as COVID-19 related variables, affect the perception of relationship quality. Additionally, we are interested in seeing if these effects are different for same sex couples.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nordinal_model <- polr(\n  relationship_quality ~ same_sex_couple + \n    sex_frequency + \n    flirts_with_partner + \n    fights_with_partner + \n    inc_change_during_pandemic + \n    subject_had_covid + \n    partner_had_covid + \n    subject_vaccinated + \n    partner_vaccinated + \n    agree_covid_approach,\n  data = hcmst, Hess = TRUE\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n:::\n\n\n\nTo ensure the validity of our analysis, we are going to test the proportional odds assumption. To do so, we can use the Brant-Wald test, which assesses whether our model fulfills this assumption.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbt <- brant(ordinal_model)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in brant(ordinal_model): 3071083 combinations in table(dv,ivs) do not\noccur. Because of that, the test results might be invalid.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(bt, digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|                                                                           |    X2| df| probability|\n|:--------------------------------------------------------------------------|-----:|--:|-----------:|\n|Omnibus                                                                    | 92.43| 96|        0.58|\n|same_sex_coupleYes                                                         |  1.94|  3|        0.58|\n|sex_frequency2_to_3_times_a_month-once_a_month_or_less                     |  2.25|  3|        0.52|\n|sex_frequencyonce_or_twice_a_week-2_to_3_times_a_month                     |  2.10|  3|        0.55|\n|sex_frequency3_to_6_times_a_week-once_or_twice_a_week                      |  1.38|  3|        0.71|\n|sex_frequencyonce_or_more_a_day-3_to_6_times_a_week                        |  0.01|  3|        1.00|\n|flirts_with_partnerless_than_once_a_month-never                            |  2.17|  3|        0.54|\n|flirts_with_partner1_to_3_times_a_month-less_than_once_a_month             |  0.17|  3|        0.98|\n|flirts_with_partneronce_a_week-1_to_3_times_a_month                        |  0.01|  3|        1.00|\n|flirts_with_partnera_few_times_a_week-once_a_week                          |  0.70|  3|        0.87|\n|flirts_with_partnerevery_day-a_few_times_a_week                            |  2.64|  3|        0.45|\n|fights_with_partner1_time-0_times                                          |  6.33|  3|        0.10|\n|fights_with_partner2_times-1_time                                          |  1.14|  3|        0.77|\n|fights_with_partner3_times-2_times                                         |  1.77|  3|        0.62|\n|fights_with_partner4_times-3_times                                         |  1.81|  3|        0.61|\n|fights_with_partner5_times-4_times                                         |  0.37|  3|        0.95|\n|fights_with_partner6_times-5_times                                         |  0.03|  3|        1.00|\n|fights_with_partner7_or_more_times-6_times                                 |  1.27|  3|        0.74|\n|inc_change_during_pandemicworse-much_worse                                 |  1.04|  3|        0.79|\n|inc_change_during_pandemicno_change-worse                                  |  0.94|  3|        0.82|\n|inc_change_during_pandemicbetter-no_change                                 |  0.26|  3|        0.97|\n|inc_change_during_pandemicmuch_better-better                               |  0.04|  3|        1.00|\n|subject_had_covidyes                                                       |  0.20|  3|        0.98|\n|partner_had_covidno                                                        |  6.81|  3|        0.08|\n|subject_vaccinatedpartially_vaccinated-not_vaccinated                      |  5.12|  3|        0.16|\n|subject_vaccinatedfully_vaccinated_no_booster-partially_vaccinated         |  4.01|  3|        0.26|\n|subject_vaccinatedfully_vaccinated_and_booster-fully_vaccinated_no_booster |  0.32|  3|        0.96|\n|partner_vaccinatedpartially_vaccinated-not_vaccinated                      |  2.28|  3|        0.52|\n|partner_vaccinatedfully_vaccinated_no_booster-partially_vaccinated         |  6.35|  3|        0.10|\n|partner_vaccinatedfully_vaccinated_and_booster-fully_vaccinated_no_booster |  0.22|  3|        0.97|\n|agree_covid_approachmostly_disagree-completely_disagree                    |  5.27|  3|        0.15|\n|agree_covid_approachmostly_agree-mostly_disagree                           |  5.21|  3|        0.16|\n|agree_covid_approachcompletely_agree-mostly_agree                          |  1.97|  3|        0.58|\n\n\n:::\n:::\n\n\n\nNote that with an $\\alpha = 0.05$, we do not have evidence of a violation of the proportional odds assumption, as indicated by the p-values in the `probability` column.\n\nHowever, during both the model fitting process and the Brant-Wald test, several warnings were issued. These are due to instances where combinations of the response variable and predictor levels have no observations. One warning from the Brant test indicates that over 3,000,000 combinations of the dependent variable (`dv`) and independent variables (`ivs`) are not present in the data set.\n\nWhen models include multiple categorical predictors with many levels, the number of possible combinations of predictors and outcomes grows exponentially. In real-world survey data, especially from large data sets, many of these combinations are either extremely rare or entirely missing. This sparsity can compromise the reliability of the Brant test, which assumes sufficient data within each combination to estimate parameters.\n\nOne potential solution is to bin levels of categorical variables that have low counts, reducing the number of empty combinations. However, when there are many predictors with multiple levels, even binning may not fully resolve the issue.\n\nThis limitation is common in multivariable modeling and reflects constraints in data collection and the inherent sparsity of data. As such, the results from diagnostics like the Brant test should be interpreted with caution.\n\n#### 5. Model Interpretation\n\nFirst, we will calculate the P-value (as `polr()`does not calculate it) and we are going to exponentiate the estimates for easier interpretation of the log-odds.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_partial_ordinal_model <- cbind(tidy(ordinal_model),\n  p.value = pnorm(abs(tidy(ordinal_model)$statistic), lower.tail = FALSE) * 2) |>\n  mutate_if(is.numeric, round, 2)\n\nsummary_partial_ordinal_model <- summary_partial_ordinal_model |>\n  mutate(exp_estimate = exp(estimate)) |> \n  filter(p.value < 0.05, \n         coef.type == \"coefficient\")\n\nkable(summary_partial_ordinal_model, digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|term                                                   | estimate| std.error| statistic|coef.type   | p.value| exp_estimate|\n|:------------------------------------------------------|--------:|---------:|---------:|:-----------|-------:|------------:|\n|same_sex_coupleYes                                     |    -0.53|      0.22|     -2.41|coefficient |    0.02|         0.59|\n|sex_frequency2_to_3_times_a_month-once_a_month_or_less |     0.64|      0.15|      4.18|coefficient |    0.00|         1.90|\n|flirts_with_partnerevery_day-a_few_times_a_week        |     0.89|      0.28|      3.16|coefficient |    0.00|         2.44|\n|fights_with_partner1_time-0_times                      |    -0.65|      0.14|     -4.55|coefficient |    0.00|         0.52|\n|inc_change_during_pandemicno_change-worse              |     0.53|      0.17|      3.18|coefficient |    0.00|         1.70|\n|partner_vaccinatedpartially_vaccinated-not_vaccinated  |     0.87|      0.30|      2.88|coefficient |    0.00|         2.39|\n|agree_covid_approachmostly_agree-mostly_disagree       |     1.20|      0.40|      3.02|coefficient |    0.00|         3.32|\n|agree_covid_approachcompletely_agree-mostly_agree      |     0.58|      0.13|      4.43|coefficient |    0.00|         1.79|\n\n\n:::\n:::\n\n\n\nPositive estimates are associated with higher relationship quality, while negative estimates are associated with lower relationship quality. Additionally, the exponential of the estimate is the odds ratio, which represents how much the odds of having a higher `relationship_quality` level changes between levels.\n\nConsidering\n\n-   If $OR > 1: (OR - 1) \\times 100%$ = % Higher odds\n-   If $OR < 1: (1 - OR) \\times 100%$ = % Lower odds\n\nWe can interpret these estimates:\n\n-   `same_sex_couple`: Being in a same-sex couple is associated with 41% lower odds of reporting better relationship quality compared to different-sex couples.\n-   `sex_frequency`: People who have sex 2-3 times a month have 90% higher odds of reporting better relationship quality that those who have sex once a month or less.\n-   `flirts_with_partner`: Flirting every day vs a few times per week is associated with 140% higher odds of better relationship quality.\n-   `fights_with_partner`: Fighting once vs none is associated with 48% lower odds of better relationship quality.\n-   `inc_change_during_pandemic`: Individuals whose income did not change during the pandemic had 70% higher odds of reporting better relationship quality vs those whose income was worse.\n-   `partner_vaccinated`: Having a partner who is partially vaccinated is associated with 140% higher odds of having a better relationship quality.\n-   `agree_covid_approach`: Mostly agreeing with a partner's approach to COVID vs mostly disagreeing is associated with 230% higher odds of better relationship quality.\n-   `agree_covid_approach`: Completely agreeing with a partner's approach to COVID vs mostly agreeing is associated with 80% higher odds of better relationship quality.\n\n#### 6. Prediction\n\nWith our fitted model, we are now able to make predictions on new examples. Based on behavioral and COVID-19 related variables, we can predict the probabilities of the different levels of perceived `relationship_quality` for a specific subject. Focusing on the levels that were associated with statistically significant factors:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(predict(ordinal_model, tibble(\n  same_sex_couple = \"Yes\",\n  sex_frequency = \"once_a_month_or_less\",\n  flirts_with_partner = \"a_few_times_a_week\",\n  fights_with_partner = \"1_time\",\n  inc_change_during_pandemic = \"worse\",\n  subject_had_covid = \"no\",\n  partner_had_covid = \"no\", \n  subject_vaccinated = \"not_vaccinated\", \n  partner_vaccinated = \"not_vaccinated\",\n  agree_covid_approach = \"mostly_disagree\"\n  ), \n  type = \"probs\"),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvery_poor      poor      fair      good excellent \n     0.08      0.32      0.41      0.17      0.02 \n```\n\n\n:::\n\n```{.r .cell-code}\nround(predict(ordinal_model, tibble(\n  same_sex_couple = \"No\",\n  sex_frequency = \"2_to_3_times_a_month\",\n  flirts_with_partner = \"every_day\",\n  fights_with_partner = \"0_times\",\n  inc_change_during_pandemic = \"no_change\",\n  subject_had_covid = \"no\",\n  partner_had_covid = \"no\", \n  subject_vaccinated = \"not_vaccinated\", \n  partner_vaccinated = \"partially_vaccinated\",\n  agree_covid_approach = \"mostly_agree\"\n  ), \n  type = \"probs\"), 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvery_poor      poor      fair      good excellent \n     0.00      0.00      0.02      0.20      0.78 \n```\n\n\n:::\n:::\n\n\n\nWe can note that a subject involved in a same-sex couple, who has sex once a month or less, flirts with their partner a few times a week, fought with their partner once in the last week, experienced worsened income during the pandemic, is not vaccinated (nor is their partner), and mostly disagrees with their partner's approach to COVID, has a 41% probability of perceiving their relationship quality as `fair`.\n\nOn the other hand, a subject involved in a different-sex couple, who has sex two or three times a month, flirts with their partner on a daily basis, has not fought with their partner in the last week, experienced no change in income during the pandemic, has a partially vaccinated partner, and mostly agrees with their partner's approach to COVID, has a 78% probability of perceiving their relationship quality as `excellent`.\n\n### Discussion\n\nThis analysis explored how relationship habits, particularly in the context of the COVID-19 pandemic relate to perceived relationship quality across different types of couples. Through the analysis, results highlight that relationship behaviors and shared beliefs meaningfully affect how individuals evaluate their relationships. More specifically, we could conclude the following:\n\n-   **Behaviors are important**: More frequent sex and flirting are associated with higher perceived relationship quality, while more frequent fighting affects that perception negatively.\n\n-   **Shared beliefs are beneficial**: Agreement with a partner's approach to COVID-19 was a very strong predictor of relationship quality. Moving in a direction of agreement had a significant positive association.\n\n-   **External factors play a role as well**: Financial stability during the pandemic, as well as the partner's vaccination status were also linked to better relationship quality, suggesting that alignment on external factors, such as health and financial concerns, could cause stress in couple dynamics contribute to positive perceptions.\n\n-   **Perceived relationship quality varied by couple type**: Individuals in same-sex couples, on average, reported slightly lower relationship quality compared to those in different-sex couples. Although this difference was modest, it was statistically significant, which may warrant a need for further exploration into the factors that may influence these perceptions.\n\n-   **Encoding and model choice are critical**: Model selection is tied to the type of response variable. Ordinal categorical response variables are tied to ordinal logistic regression models. Also, encoding categorical predictors must be done with care to ensure meaningful and interpretable contrasts.\n\n-   **Sparsity may affect results**: When categorical variables have many levels, certain combinations of predictors may be underrepresented. This sparsity may impact the model and its assumptions, so caution is advised when drawing conclusions from underpopulated subgroups.\n",
    "supporting": [
      "hcmst_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}